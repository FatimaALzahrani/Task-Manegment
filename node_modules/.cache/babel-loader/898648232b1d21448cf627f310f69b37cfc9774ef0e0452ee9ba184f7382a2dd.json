{"ast":null,"code":"import { createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createCommentVNode as _createCommentVNode, vModelText as _vModelText, withDirectives as _withDirectives, withKeys as _withKeys, withModifiers as _withModifiers } from \"vue\";\nconst _hoisted_1 = {\n  class: \"fade-in\"\n};\nconst _hoisted_2 = {\n  class: \"flex justify-between items-center mb-6\"\n};\nconst _hoisted_3 = {\n  class: \"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\"\n};\nconst _hoisted_4 = [\"src\", \"alt\"];\nconst _hoisted_5 = {\n  class: \"p-4\"\n};\nconst _hoisted_6 = {\n  class: \"text-lg font-semibold text-gray-800\"\n};\nconst _hoisted_7 = {\n  class: \"text-sm text-gray-600 mt-2\"\n};\nconst _hoisted_8 = {\n  class: \"flex justify-between mt-4 pt-4 border-t border-gray-100\"\n};\nconst _hoisted_9 = [\"onClick\"];\nconst _hoisted_10 = [\"onClick\"];\nconst _hoisted_11 = {\n  key: 0,\n  class: \"lg:col-span-3 text-center py-12 bg-white rounded-lg shadow-md\"\n};\nconst _hoisted_12 = {\n  class: \"modal-content\"\n};\nconst _hoisted_13 = {\n  class: \"flex justify-between items-center mb-4\"\n};\nconst _hoisted_14 = {\n  class: \"text-xl font-bold text-gray-800\"\n};\nconst _hoisted_15 = [\"src\", \"alt\"];\nconst _hoisted_16 = {\n  class: \"mb-4\"\n};\nconst _hoisted_17 = {\n  class: \"mb-4\"\n};\nconst _hoisted_18 = {\n  class: \"mb-4\"\n};\nconst _hoisted_19 = {\n  class: \"mb-4\"\n};\nconst _hoisted_20 = {\n  class: \"bg-gray-50 p-3 rounded-lg max-h-40 overflow-y-auto mb-2\"\n};\nconst _hoisted_21 = {\n  key: 0,\n  class: \"text-gray-500 text-sm\"\n};\nconst _hoisted_22 = [\"onClick\"];\nconst _hoisted_23 = {\n  class: \"flex\"\n};\nconst _hoisted_24 = {\n  class: \"flex justify-between\"\n};\nconst _hoisted_25 = {\n  class: \"modal-content\"\n};\nconst _hoisted_26 = {\n  class: \"flex justify-between items-center mb-4\"\n};\nconst _hoisted_27 = {\n  class: \"mb-4\"\n};\nconst _hoisted_28 = {\n  class: \"mb-4\"\n};\nconst _hoisted_29 = {\n  class: \"mb-4\"\n};\nconst _hoisted_30 = {\n  class: \"flex justify-end\"\n};\nconst _hoisted_31 = [\"disabled\"];\nconst _hoisted_32 = {\n  key: 0,\n  class: \"fas fa-spinner fa-spin ml-1\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_cache[21] || (_cache[21] = _createElementVNode(\"h1\", {\n    class: \"text-2xl font-bold text-gray-800\"\n  }, \"مخططات سير العمل\", -1)), _createElementVNode(\"button\", {\n    onClick: _cache[0] || (_cache[0] = $event => $setup.showAddWorkflowModal = true),\n    class: \"btn btn-primary\"\n  }, _cache[20] || (_cache[20] = [_createElementVNode(\"i\", {\n    class: \"fas fa-plus ml-2\"\n  }, null, -1), _createTextVNode(\"إضافة مخطط جديد \")]))]), _createElementVNode(\"div\", _hoisted_3, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.workflows, workflow => {\n    return _openBlock(), _createElementBlock(\"div\", {\n      key: workflow.id,\n      class: \"card hover:shadow-lg transition-shadow duration-200\"\n    }, [_createElementVNode(\"img\", {\n      src: workflow.imageUrl,\n      alt: workflow.title,\n      class: \"w-full h-48 object-cover rounded-t-lg\"\n    }, null, 8, _hoisted_4), _createElementVNode(\"div\", _hoisted_5, [_createElementVNode(\"h3\", _hoisted_6, _toDisplayString(workflow.title), 1), _createElementVNode(\"p\", _hoisted_7, _toDisplayString(workflow.description), 1), _createElementVNode(\"div\", _hoisted_8, [_createElementVNode(\"button\", {\n      onClick: $event => $setup.openWorkflowDetails(workflow),\n      class: \"text-primary-600 hover:text-primary-800\"\n    }, _cache[22] || (_cache[22] = [_createElementVNode(\"i\", {\n      class: \"fas fa-info-circle ml-1\"\n    }, null, -1), _createTextVNode(\"التفاصيل \")]), 8, _hoisted_9), _createElementVNode(\"button\", {\n      onClick: $event => $setup.deleteWorkflow(workflow),\n      class: \"text-red-600 hover:text-red-800\"\n    }, _cache[23] || (_cache[23] = [_createElementVNode(\"i\", {\n      class: \"fas fa-trash-alt ml-1\"\n    }, null, -1), _createTextVNode(\"حذف \")]), 8, _hoisted_10)])])]);\n  }), 128)), $setup.workflows.length === 0 ? (_openBlock(), _createElementBlock(\"div\", _hoisted_11, [_cache[25] || (_cache[25] = _createElementVNode(\"i\", {\n    class: \"fas fa-project-diagram text-5xl text-gray-300 mb-4\"\n  }, null, -1)), _cache[26] || (_cache[26] = _createElementVNode(\"h3\", {\n    class: \"text-xl font-semibold text-gray-600 mb-2\"\n  }, \"لا توجد مخططات بعد\", -1)), _cache[27] || (_cache[27] = _createElementVNode(\"p\", {\n    class: \"text-gray-500 mb-4\"\n  }, \"قم بإضافة مخططات سير العمل لتوثيق عملية البحث\", -1)), _createElementVNode(\"button\", {\n    onClick: _cache[1] || (_cache[1] = $event => $setup.showAddWorkflowModal = true),\n    class: \"btn btn-primary\"\n  }, _cache[24] || (_cache[24] = [_createElementVNode(\"i\", {\n    class: \"fas fa-plus ml-2\"\n  }, null, -1), _createTextVNode(\"إضافة مخطط جديد \")]))])) : _createCommentVNode(\"\", true)]), $setup.selectedWorkflow ? (_openBlock(), _createElementBlock(\"div\", {\n    key: 0,\n    class: \"modal-overlay\",\n    onClick: _cache[12] || (_cache[12] = _withModifiers((...args) => $setup.closeDetails && $setup.closeDetails(...args), [\"self\"]))\n  }, [_createElementVNode(\"div\", _hoisted_12, [_createElementVNode(\"div\", _hoisted_13, [_createElementVNode(\"h2\", _hoisted_14, _toDisplayString($setup.selectedWorkflow.title), 1), _createElementVNode(\"button\", {\n    onClick: _cache[2] || (_cache[2] = (...args) => $setup.closeDetails && $setup.closeDetails(...args)),\n    class: \"text-gray-500 hover:text-gray-700\"\n  }, _cache[28] || (_cache[28] = [_createElementVNode(\"i\", {\n    class: \"fas fa-times\"\n  }, null, -1)]))]), _createElementVNode(\"img\", {\n    src: $setup.selectedWorkflow.imageUrl,\n    alt: $setup.selectedWorkflow.title,\n    class: \"w-full h-64 object-contain rounded-lg mb-4\"\n  }, null, 8, _hoisted_15), _createElementVNode(\"div\", _hoisted_16, [_cache[29] || (_cache[29] = _createElementVNode(\"label\", {\n    class: \"form-label\"\n  }, \"العنوان\", -1)), _withDirectives(_createElementVNode(\"input\", {\n    type: \"text\",\n    \"onUpdate:modelValue\": _cache[3] || (_cache[3] = $event => $setup.selectedWorkflow.title = $event),\n    class: \"form-input\"\n  }, null, 512), [[_vModelText, $setup.selectedWorkflow.title]])]), _createElementVNode(\"div\", _hoisted_17, [_cache[30] || (_cache[30] = _createElementVNode(\"label\", {\n    class: \"form-label\"\n  }, \"الوصف\", -1)), _withDirectives(_createElementVNode(\"textarea\", {\n    \"onUpdate:modelValue\": _cache[4] || (_cache[4] = $event => $setup.selectedWorkflow.description = $event),\n    rows: \"4\",\n    class: \"form-input\"\n  }, null, 512), [[_vModelText, $setup.selectedWorkflow.description]])]), _createElementVNode(\"div\", _hoisted_18, [_cache[31] || (_cache[31] = _createElementVNode(\"label\", {\n    class: \"form-label\"\n  }, \"الملاحظات\", -1)), _withDirectives(_createElementVNode(\"textarea\", {\n    \"onUpdate:modelValue\": _cache[5] || (_cache[5] = $event => $setup.selectedWorkflow.notes = $event),\n    rows: \"4\",\n    class: \"form-input\"\n  }, null, 512), [[_vModelText, $setup.selectedWorkflow.notes]])]), _createElementVNode(\"div\", _hoisted_19, [_cache[33] || (_cache[33] = _createElementVNode(\"label\", {\n    class: \"form-label\"\n  }, \"المهام المرتبطة\", -1)), _createElementVNode(\"div\", _hoisted_20, [!$setup.selectedWorkflow.relatedTasks || $setup.selectedWorkflow.relatedTasks.length === 0 ? (_openBlock(), _createElementBlock(\"div\", _hoisted_21, \" لا توجد مهام مرتبطة بعد \")) : (_openBlock(true), _createElementBlock(_Fragment, {\n    key: 1\n  }, _renderList($setup.selectedWorkflow.relatedTasks, (task, index) => {\n    return _openBlock(), _createElementBlock(\"div\", {\n      key: index,\n      class: \"mb-3 p-3 bg-white rounded-lg shadow-sm flex justify-between items-center\"\n    }, [_createElementVNode(\"span\", null, _toDisplayString(task), 1), _createElementVNode(\"button\", {\n      onClick: $event => $setup.removeRelatedTask(index),\n      class: \"text-red-600 text-xs hover:text-red-800\"\n    }, _cache[32] || (_cache[32] = [_createElementVNode(\"i\", {\n      class: \"fas fa-times\"\n    }, null, -1)]), 8, _hoisted_22)]);\n  }), 128))]), _createElementVNode(\"div\", _hoisted_23, [_withDirectives(_createElementVNode(\"input\", {\n    type: \"text\",\n    \"onUpdate:modelValue\": _cache[6] || (_cache[6] = $event => $setup.newRelatedTask = $event),\n    placeholder: \"أضف مهمة مرتبطة...\",\n    class: \"form-input flex-grow\",\n    onKeyup: _cache[7] || (_cache[7] = _withKeys((...args) => $setup.addRelatedTask && $setup.addRelatedTask(...args), [\"enter\"]))\n  }, null, 544), [[_vModelText, $setup.newRelatedTask]]), _createElementVNode(\"button\", {\n    onClick: _cache[8] || (_cache[8] = (...args) => $setup.addRelatedTask && $setup.addRelatedTask(...args)),\n    class: \"btn btn-primary mr-2\"\n  }, \"إضافة\")])]), _createElementVNode(\"div\", _hoisted_24, [_createElementVNode(\"div\", null, [_createElementVNode(\"button\", {\n    onClick: _cache[9] || (_cache[9] = (...args) => $setup.saveWorkflowChanges && $setup.saveWorkflowChanges(...args)),\n    class: \"btn btn-primary ml-2\"\n  }, \"حفظ التغييرات\"), _createElementVNode(\"button\", {\n    onClick: _cache[10] || (_cache[10] = (...args) => $setup.closeDetails && $setup.closeDetails(...args)),\n    class: \"btn btn-outline\"\n  }, \"إلغاء\")]), _createElementVNode(\"button\", {\n    onClick: _cache[11] || (_cache[11] = $event => $setup.deleteWorkflow($setup.selectedWorkflow)),\n    class: \"btn btn-danger\"\n  }, \"حذف المخطط\")])])])) : _createCommentVNode(\"\", true), $setup.showAddWorkflowModal ? (_openBlock(), _createElementBlock(\"div\", {\n    key: 1,\n    class: \"modal-overlay\",\n    onClick: _cache[19] || (_cache[19] = _withModifiers($event => $setup.showAddWorkflowModal = false, [\"self\"]))\n  }, [_createElementVNode(\"div\", _hoisted_25, [_createElementVNode(\"div\", _hoisted_26, [_cache[35] || (_cache[35] = _createElementVNode(\"h2\", {\n    class: \"text-xl font-bold text-gray-800\"\n  }, \"إضافة مخطط جديد\", -1)), _createElementVNode(\"button\", {\n    onClick: _cache[13] || (_cache[13] = $event => $setup.showAddWorkflowModal = false),\n    class: \"text-gray-500 hover:text-gray-700\"\n  }, _cache[34] || (_cache[34] = [_createElementVNode(\"i\", {\n    class: \"fas fa-times\"\n  }, null, -1)]))]), _createElementVNode(\"div\", _hoisted_27, [_cache[36] || (_cache[36] = _createElementVNode(\"label\", {\n    class: \"form-label\"\n  }, \"العنوان\", -1)), _withDirectives(_createElementVNode(\"input\", {\n    type: \"text\",\n    \"onUpdate:modelValue\": _cache[14] || (_cache[14] = $event => $setup.newWorkflow.title = $event),\n    class: \"form-input\",\n    required: \"\"\n  }, null, 512), [[_vModelText, $setup.newWorkflow.title]])]), _createElementVNode(\"div\", _hoisted_28, [_cache[37] || (_cache[37] = _createElementVNode(\"label\", {\n    class: \"form-label\"\n  }, \"الوصف\", -1)), _withDirectives(_createElementVNode(\"textarea\", {\n    \"onUpdate:modelValue\": _cache[15] || (_cache[15] = $event => $setup.newWorkflow.description = $event),\n    rows: \"4\",\n    class: \"form-input\",\n    required: \"\"\n  }, null, 512), [[_vModelText, $setup.newWorkflow.description]])]), _createElementVNode(\"div\", _hoisted_29, [_cache[38] || (_cache[38] = _createElementVNode(\"label\", {\n    class: \"form-label\"\n  }, \"صورة المخطط\", -1)), _createElementVNode(\"input\", {\n    type: \"file\",\n    accept: \"image/*\",\n    onChange: _cache[16] || (_cache[16] = (...args) => $setup.handleFileUpload && $setup.handleFileUpload(...args)),\n    class: \"form-input\",\n    required: \"\"\n  }, null, 32)]), _createElementVNode(\"div\", _hoisted_30, [_createElementVNode(\"button\", {\n    onClick: _cache[17] || (_cache[17] = $event => $setup.showAddWorkflowModal = false),\n    class: \"btn btn-outline ml-2\"\n  }, \"إلغاء\"), _createElementVNode(\"button\", {\n    onClick: _cache[18] || (_cache[18] = (...args) => $setup.addNewWorkflow && $setup.addNewWorkflow(...args)),\n    class: \"btn btn-primary\",\n    disabled: $setup.isUploading\n  }, [$setup.isUploading ? (_openBlock(), _createElementBlock(\"i\", _hoisted_32)) : _createCommentVNode(\"\", true), _cache[39] || (_cache[39] = _createTextVNode(\" إضافة المخطط \"))], 8, _hoisted_31)])])])) : _createCommentVNode(\"\", true)]);\n}","map":{"version":3,"names":["class","key","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","onClick","_cache","$event","$setup","showAddWorkflowModal","_createTextVNode","_hoisted_3","_Fragment","_renderList","workflows","workflow","id","src","imageUrl","alt","title","_hoisted_4","_hoisted_5","_hoisted_6","_toDisplayString","_hoisted_7","description","_hoisted_8","openWorkflowDetails","_hoisted_9","deleteWorkflow","_hoisted_10","length","_hoisted_11","_createCommentVNode","selectedWorkflow","_withModifiers","args","closeDetails","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","type","_hoisted_17","rows","_hoisted_18","notes","_hoisted_19","_hoisted_20","relatedTasks","_hoisted_21","task","index","removeRelatedTask","_hoisted_22","_hoisted_23","newRelatedTask","placeholder","onKeyup","_withKeys","addRelatedTask","_hoisted_24","saveWorkflowChanges","_hoisted_25","_hoisted_26","_hoisted_27","newWorkflow","required","_hoisted_28","_hoisted_29","accept","onChange","handleFileUpload","_hoisted_30","addNewWorkflow","disabled","isUploading","_hoisted_32","_hoisted_31"],"sources":["C:\\Users\\فاطمة الزهراني\\Downloads\\research-task-manager-updated\\task-manager\\src\\views\\Workflow.vue"],"sourcesContent":["<template>\n  <div class=\"fade-in\">\n    <div class=\"flex justify-between items-center mb-6\">\n      <h1 class=\"text-2xl font-bold text-gray-800\">مخططات سير العمل</h1>\n      <button @click=\"showAddWorkflowModal = true\" class=\"btn btn-primary\">\n        <i class=\"fas fa-plus ml-2\"></i>إضافة مخطط جديد\n      </button>\n    </div>\n    \n    <div class=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n      <div v-for=\"workflow in workflows\" :key=\"workflow.id\" class=\"card hover:shadow-lg transition-shadow duration-200\">\n        <img :src=\"workflow.imageUrl\" :alt=\"workflow.title\" class=\"w-full h-48 object-cover rounded-t-lg\">\n        \n        <div class=\"p-4\">\n          <h3 class=\"text-lg font-semibold text-gray-800\">{{ workflow.title }}</h3>\n          <p class=\"text-sm text-gray-600 mt-2\">{{ workflow.description }}</p>\n          \n          <div class=\"flex justify-between mt-4 pt-4 border-t border-gray-100\">\n            <button @click=\"openWorkflowDetails(workflow)\" class=\"text-primary-600 hover:text-primary-800\">\n              <i class=\"fas fa-info-circle ml-1\"></i>التفاصيل\n            </button>\n            \n            <button @click=\"deleteWorkflow(workflow)\" class=\"text-red-600 hover:text-red-800\">\n              <i class=\"fas fa-trash-alt ml-1\"></i>حذف\n            </button>\n          </div>\n        </div>\n      </div>\n      \n      <div v-if=\"workflows.length === 0\" class=\"lg:col-span-3 text-center py-12 bg-white rounded-lg shadow-md\">\n        <i class=\"fas fa-project-diagram text-5xl text-gray-300 mb-4\"></i>\n        <h3 class=\"text-xl font-semibold text-gray-600 mb-2\">لا توجد مخططات بعد</h3>\n        <p class=\"text-gray-500 mb-4\">قم بإضافة مخططات سير العمل لتوثيق عملية البحث</p>\n        <button @click=\"showAddWorkflowModal = true\" class=\"btn btn-primary\">\n          <i class=\"fas fa-plus ml-2\"></i>إضافة مخطط جديد\n        </button>\n      </div>\n    </div>\n    \n    <!-- Workflow Details Modal -->\n    <div v-if=\"selectedWorkflow\" class=\"modal-overlay\" @click.self=\"closeDetails\">\n      <div class=\"modal-content\">\n        <div class=\"flex justify-between items-center mb-4\">\n          <h2 class=\"text-xl font-bold text-gray-800\">{{ selectedWorkflow.title }}</h2>\n          <button @click=\"closeDetails\" class=\"text-gray-500 hover:text-gray-700\">\n            <i class=\"fas fa-times\"></i>\n          </button>\n        </div>\n        \n        <img :src=\"selectedWorkflow.imageUrl\" :alt=\"selectedWorkflow.title\" class=\"w-full h-64 object-contain rounded-lg mb-4\">\n        \n        <div class=\"mb-4\">\n          <label class=\"form-label\">العنوان</label>\n          <input type=\"text\" v-model=\"selectedWorkflow.title\" class=\"form-input\">\n        </div>\n        \n        <div class=\"mb-4\">\n          <label class=\"form-label\">الوصف</label>\n          <textarea v-model=\"selectedWorkflow.description\" rows=\"4\" class=\"form-input\"></textarea>\n        </div>\n        \n        <div class=\"mb-4\">\n          <label class=\"form-label\">الملاحظات</label>\n          <textarea v-model=\"selectedWorkflow.notes\" rows=\"4\" class=\"form-input\"></textarea>\n        </div>\n        \n        <div class=\"mb-4\">\n          <label class=\"form-label\">المهام المرتبطة</label>\n          <div class=\"bg-gray-50 p-3 rounded-lg max-h-40 overflow-y-auto mb-2\">\n            <div v-if=\"!selectedWorkflow.relatedTasks || selectedWorkflow.relatedTasks.length === 0\" class=\"text-gray-500 text-sm\">\n              لا توجد مهام مرتبطة بعد\n            </div>\n            <div v-else v-for=\"(task, index) in selectedWorkflow.relatedTasks\" :key=\"index\" class=\"mb-3 p-3 bg-white rounded-lg shadow-sm flex justify-between items-center\">\n              <span>{{ task }}</span>\n              <button @click=\"removeRelatedTask(index)\" class=\"text-red-600 text-xs hover:text-red-800\">\n                <i class=\"fas fa-times\"></i>\n              </button>\n            </div>\n          </div>\n          \n          <div class=\"flex\">\n            <input \n              type=\"text\" \n              v-model=\"newRelatedTask\" \n              placeholder=\"أضف مهمة مرتبطة...\" \n              class=\"form-input flex-grow\"\n              @keyup.enter=\"addRelatedTask\"\n            >\n            <button @click=\"addRelatedTask\" class=\"btn btn-primary mr-2\">إضافة</button>\n          </div>\n        </div>\n        \n        <div class=\"flex justify-between\">\n          <div>\n            <button @click=\"saveWorkflowChanges\" class=\"btn btn-primary ml-2\">حفظ التغييرات</button>\n            <button @click=\"closeDetails\" class=\"btn btn-outline\">إلغاء</button>\n          </div>\n          <button @click=\"deleteWorkflow(selectedWorkflow)\" class=\"btn btn-danger\">حذف المخطط</button>\n        </div>\n      </div>\n    </div>\n    \n    <!-- Add Workflow Modal -->\n    <div v-if=\"showAddWorkflowModal\" class=\"modal-overlay\" @click.self=\"showAddWorkflowModal = false\">\n      <div class=\"modal-content\">\n        <div class=\"flex justify-between items-center mb-4\">\n          <h2 class=\"text-xl font-bold text-gray-800\">إضافة مخطط جديد</h2>\n          <button @click=\"showAddWorkflowModal = false\" class=\"text-gray-500 hover:text-gray-700\">\n            <i class=\"fas fa-times\"></i>\n          </button>\n        </div>\n        \n        <div class=\"mb-4\">\n          <label class=\"form-label\">العنوان</label>\n          <input type=\"text\" v-model=\"newWorkflow.title\" class=\"form-input\" required>\n        </div>\n        \n        <div class=\"mb-4\">\n          <label class=\"form-label\">الوصف</label>\n          <textarea v-model=\"newWorkflow.description\" rows=\"4\" class=\"form-input\" required></textarea>\n        </div>\n        \n        <div class=\"mb-4\">\n          <label class=\"form-label\">صورة المخطط</label>\n          <input type=\"file\" accept=\"image/*\" @change=\"handleFileUpload\" class=\"form-input\" required>\n        </div>\n        \n        <div class=\"flex justify-end\">\n          <button @click=\"showAddWorkflowModal = false\" class=\"btn btn-outline ml-2\">إلغاء</button>\n          <button @click=\"addNewWorkflow\" class=\"btn btn-primary\" :disabled=\"isUploading\">\n            <i v-if=\"isUploading\" class=\"fas fa-spinner fa-spin ml-1\"></i>\n            إضافة المخطط\n          </button>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { ref, onMounted } from 'vue'\nimport { getDatabase, ref as dbRef, onValue, push, update, remove } from 'firebase/database'\nimport { getStorage, ref as storageRef, uploadBytesResumable, getDownloadURL, deleteObject } from 'firebase/storage'\n\nexport default {\n  name: 'Workflow',\n  setup() {\n    const db = getDatabase()\n    const storage = getStorage()\n    \n    // Workflows data\n    const workflows = ref([])\n    const selectedWorkflow = ref(null)\n    const newRelatedTask = ref('')\n    \n    // New workflow modal\n    const showAddWorkflowModal = ref(false)\n    const newWorkflow = ref({\n      title: '',\n      description: '',\n      notes: '',\n      relatedTasks: []\n    })\n    const selectedFile = ref(null)\n    const isUploading = ref(false)\n    \n    // Load workflows from Firebase\n    const loadWorkflows = () => {\n      const workflowsRef = dbRef(db, 'workflows')\n      onValue(workflowsRef, (snapshot) => {\n        const data = snapshot.val()\n        if (data) {\n          workflows.value = Object.entries(data).map(([id, workflow]) => ({\n            id,\n            ...workflow,\n            notes: workflow.notes || '',\n            relatedTasks: workflow.relatedTasks || []\n          }))\n        } else {\n          workflows.value = []\n        }\n      })\n    }\n    \n    // Workflow details\n    const openWorkflowDetails = (workflow) => {\n      selectedWorkflow.value = { ...workflow }\n    }\n    \n    const closeDetails = () => {\n      selectedWorkflow.value = null\n      newRelatedTask.value = ''\n    }\n    \n    const saveWorkflowChanges = () => {\n      if (!selectedWorkflow.value) return\n      \n      const workflowRef = dbRef(db, `workflows/${selectedWorkflow.value.id}`)\n      update(workflowRef, {\n        title: selectedWorkflow.value.title,\n        description: selectedWorkflow.value.description,\n        notes: selectedWorkflow.value.notes || '',\n        relatedTasks: selectedWorkflow.value.relatedTasks || []\n      })\n      \n      closeDetails()\n    }\n    \n    const deleteWorkflow = (workflow) => {\n      if (!workflow) return\n      \n      if (confirm('هل أنت متأكد من حذف هذا المخطط؟')) {\n        // Delete image from storage\n        if (workflow.storagePath) {\n          const fileRef = storageRef(storage, workflow.storagePath)\n          deleteObject(fileRef).catch(error => {\n            console.error('Error deleting file:', error)\n          })\n        }\n        \n        // Delete data from database\n        const workflowRef = dbRef(db, `workflows/${workflow.id}`)\n        remove(workflowRef)\n        \n        if (selectedWorkflow.value && selectedWorkflow.value.id === workflow.id) {\n          closeDetails()\n        }\n      }\n    }\n    \n    // Related tasks management\n    const addRelatedTask = () => {\n      if (!newRelatedTask.value.trim() || !selectedWorkflow.value) return\n      \n      if (!selectedWorkflow.value.relatedTasks) {\n        selectedWorkflow.value.relatedTasks = []\n      }\n      \n      selectedWorkflow.value.relatedTasks.push(newRelatedTask.value.trim())\n      newRelatedTask.value = ''\n    }\n    \n    const removeRelatedTask = (index) => {\n      if (!selectedWorkflow.value || !selectedWorkflow.value.relatedTasks) return\n      \n      selectedWorkflow.value.relatedTasks.splice(index, 1)\n    }\n    \n    // File upload\n    const handleFileUpload = (event) => {\n      selectedFile.value = event.target.files[0]\n    }\n    \n    // Add new workflow\n    const addNewWorkflow = () => {\n      if (!newWorkflow.value.title.trim() || !newWorkflow.value.description.trim() || !selectedFile.value) {\n        alert('يرجى ملء جميع الحقول المطلوبة')\n        return\n      }\n      \n      isUploading.value = true\n      \n      // Create a unique filename\n      const ext = selectedFile.value.name.split('.').pop()\n      const fileName = `workflow_${Date.now()}.${ext}`\n      const storagePath = `workflow_images/${fileName}`\n      \n      // Upload file to Firebase Storage\n      const fileRef = storageRef(storage, storagePath)\n      const uploadTask = uploadBytesResumable(fileRef, selectedFile.value)\n      \n      uploadTask.on('state_changed', \n        (snapshot) => {\n          // Progress monitoring if needed\n          const progress = (snapshot.bytesTransferred / snapshot.totalBytes) * 100\n          console.log('Upload is ' + progress + '% done')\n        }, \n        (error) => {\n          // Error handling\n          console.error('Error uploading file:', error)\n          isUploading.value = false\n          alert('حدث خطأ أثناء رفع الملف')\n        }, \n        () => {\n          // Upload completed successfully\n          getDownloadURL(uploadTask.snapshot.ref).then((downloadURL) => {\n            // Save workflow data to Firebase Database\n            const workflowsRef = dbRef(db, 'workflows')\n            push(workflowsRef, {\n              title: newWorkflow.value.title,\n              description: newWorkflow.value.description,\n              imageUrl: downloadURL,\n              storagePath: storagePath,\n              timestamp: Date.now(),\n              notes: '',\n              relatedTasks: []\n            })\n            \n            // Reset form\n            newWorkflow.value = {\n              title: '',\n              description: '',\n              notes: '',\n              relatedTasks: []\n            }\n            selectedFile.value = null\n            isUploading.value = false\n            showAddWorkflowModal.value = false\n          })\n        }\n      )\n    }\n    \n    // Initialize\n    onMounted(() => {\n      loadWorkflows()\n    })\n    \n    return {\n      workflows,\n      selectedWorkflow,\n      newRelatedTask,\n      showAddWorkflowModal,\n      newWorkflow,\n      isUploading,\n      openWorkflowDetails,\n      closeDetails,\n      saveWorkflowChanges,\n      deleteWorkflow,\n      addRelatedTask,\n      removeRelatedTask,\n      handleFileUpload,\n      addNewWorkflow\n    }\n  }\n}\n</script>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}