{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport { ref, computed, onMounted } from \"vue\";\nimport { getDatabase, ref as dbRef, onValue, push, update, remove } from \"firebase/database\";\nexport default {\n  name: \"Tasks\",\n  setup() {\n    const db = getDatabase();\n\n    // Task board columns\n    const columns = ref([{\n      id: \"tasks\",\n      name: \"لم تبدأ بعد\"\n    }, {\n      id: \"inprogress\",\n      name: \"يتم العمل عليها\"\n    }, {\n      id: \"review\",\n      name: \"تحتاج مراجعة\"\n    }, {\n      id: \"approved\",\n      name: \"تمت\"\n    }]);\n\n    // Available tags and users\n    const availableTags = ref([\"بحث\", \"كتابة\", \"تحليل\", \"تسجيل\", \"مراجعة\"]);\n    const users = ref([\"د. مها\", \"فاطمة\"]);\n\n    // Tasks data\n    const tasks = ref([]);\n    const selectedTask = ref(null);\n    const newComment = ref(\"\");\n\n    // Filters\n    const searchQuery = ref(\"\");\n    const filterPriority = ref(\"\");\n    const filterTag = ref(\"\");\n\n    // New task modal\n    const showAddTaskModal = ref(false);\n    const newTask = ref({\n      name: \"\",\n      description: \"\",\n      column: \"tasks\",\n      priority: \"متوسط\",\n      dueDate: \"\",\n      tags: [],\n      assignee: \"\",\n      comments: []\n    });\n\n    // Load tasks from Firebase\n    const loadTasks = () => {\n      const tasksRef = dbRef(db, \"tasks\");\n      onValue(tasksRef, snapshot => {\n        const data = snapshot.val();\n        if (data) {\n          tasks.value = Object.entries(data).map(([id, task]) => ({\n            id,\n            ...task,\n            comments: task.comments || [],\n            tags: task.tags || []\n          }));\n        } else {\n          tasks.value = [];\n        }\n      });\n    };\n\n    // Filter tasks by column\n    const getTasksForColumn = columnId => {\n      return tasks.value.filter(task => {\n        // Filter by column\n        if (task.column !== columnId) return false;\n\n        // Filter by search query\n        if (searchQuery.value && !task.name.includes(searchQuery.value) && !task.description.includes(searchQuery.value)) {\n          return false;\n        }\n\n        // Filter by priority\n        if (filterPriority.value && task.priority !== filterPriority.value) {\n          return false;\n        }\n\n        // Filter by tag\n        if (filterTag.value && (!task.tags || !task.tags.includes(filterTag.value))) {\n          return false;\n        }\n        return true;\n      });\n    };\n\n    // Task details\n    const openTaskDetails = task => {\n      selectedTask.value = {\n        ...task\n      };\n    };\n    const closeTaskDetails = () => {\n      selectedTask.value = null;\n      newComment.value = \"\";\n    };\n    const saveTaskChanges = () => {\n      if (!selectedTask.value) return;\n      const taskRef = dbRef(db, `tasks/${selectedTask.value.id}`);\n      update(taskRef, {\n        name: selectedTask.value.name,\n        description: selectedTask.value.description,\n        column: selectedTask.value.column,\n        priority: selectedTask.value.priority,\n        dueDate: selectedTask.value.dueDate,\n        tags: selectedTask.value.tags || [],\n        assignee: selectedTask.value.assignee,\n        comments: selectedTask.value.comments || []\n      });\n      closeTaskDetails();\n    };\n    const deleteTask = () => {\n      if (!selectedTask.value) return;\n      if (confirm(\"هل أنت متأكد من حذف هذه المهمة؟\")) {\n        const taskRef = dbRef(db, `tasks/${selectedTask.value.id}`);\n        remove(taskRef);\n        closeTaskDetails();\n      }\n    };\n    const addComment = () => {\n      if (!newComment.value.trim() || !selectedTask.value) return;\n      if (!selectedTask.value.comments) {\n        selectedTask.value.comments = [];\n      }\n      selectedTask.value.comments.push(newComment.value.trim());\n      newComment.value = \"\";\n    };\n\n    // Tag management\n    const toggleTag = tag => {\n      if (!selectedTask.value) return;\n      if (!selectedTask.value.tags) {\n        selectedTask.value.tags = [];\n      }\n      const index = selectedTask.value.tags.indexOf(tag);\n      if (index === -1) {\n        selectedTask.value.tags.push(tag);\n      } else {\n        selectedTask.value.tags.splice(index, 1);\n      }\n    };\n    const toggleNewTaskTag = tag => {\n      const index = newTask.value.tags.indexOf(tag);\n      if (index === -1) {\n        newTask.value.tags.push(tag);\n      } else {\n        newTask.value.tags.splice(index, 1);\n      }\n    };\n\n    // Add new task\n    const addNewTask = () => {\n      if (!newTask.value.name.trim()) {\n        alert(\"يرجى إدخال اسم المهمة\");\n        return;\n      }\n      const tasksRef = dbRef(db, \"tasks\");\n      push(tasksRef, {\n        name: newTask.value.name,\n        description: newTask.value.description,\n        column: newTask.value.column,\n        priority: newTask.value.priority,\n        dueDate: newTask.value.dueDate,\n        tags: newTask.value.tags,\n        assignee: newTask.value.assignee,\n        comments: newTask.value.comments,\n        dateCreated: new Date().toISOString()\n      });\n\n      // Reset form\n      newTask.value = {\n        name: \"\",\n        description: \"\",\n        column: \"tasks\",\n        priority: \"متوسط\",\n        dueDate: \"\",\n        tags: [],\n        assignee: \"\",\n        comments: []\n      };\n      showAddTaskModal.value = false;\n    };\n\n    // Helper functions\n    const truncateText = (text, maxLength) => {\n      if (!text) return \"\";\n      return text.length > maxLength ? text.substring(0, maxLength) + \"...\" : text;\n    };\n    const getPriorityClass = priority => {\n      switch (priority) {\n        case \"عاجل\":\n          return \"bg-red-100 text-red-800\";\n        case \"متوسط\":\n          return \"bg-yellow-100 text-yellow-800\";\n        case \"منخفض\":\n          return \"bg-green-100 text-green-800\";\n        default:\n          return \"bg-gray-100 text-gray-800\";\n      }\n    };\n\n    // Initialize\n    onMounted(() => {\n      loadTasks();\n\n      // Initialize drag and drop (would be implemented with vuedraggable in a real app)\n      // This is a placeholder for the actual implementation\n      console.log(\"Drag and drop would be initialized here\");\n    });\n    return {\n      columns,\n      tasks,\n      selectedTask,\n      newComment,\n      searchQuery,\n      filterPriority,\n      filterTag,\n      availableTags,\n      users,\n      showAddTaskModal,\n      newTask,\n      getTasksForColumn,\n      openTaskDetails,\n      closeTaskDetails,\n      saveTaskChanges,\n      deleteTask,\n      addComment,\n      toggleTag,\n      toggleNewTaskTag,\n      addNewTask,\n      truncateText,\n      getPriorityClass\n    };\n  }\n};","map":{"version":3,"names":["ref","computed","onMounted","getDatabase","dbRef","onValue","push","update","remove","name","setup","db","columns","id","availableTags","users","tasks","selectedTask","newComment","searchQuery","filterPriority","filterTag","showAddTaskModal","newTask","description","column","priority","dueDate","tags","assignee","comments","loadTasks","tasksRef","snapshot","data","val","value","Object","entries","map","task","getTasksForColumn","columnId","filter","includes","openTaskDetails","closeTaskDetails","saveTaskChanges","taskRef","deleteTask","confirm","addComment","trim","toggleTag","tag","index","indexOf","splice","toggleNewTaskTag","addNewTask","alert","dateCreated","Date","toISOString","truncateText","text","maxLength","length","substring","getPriorityClass","console","log"],"sources":["C:\\Users\\فاطمة الزهراني\\Downloads\\research-task-manager-updated\\task-manager\\src\\views\\Tasks.vue"],"sourcesContent":["<template>\n  <div class=\"fade-in\">\n    <div class=\"flex justify-between items-center mb-6\">\n      <h1 class=\"text-2xl font-bold text-gray-800\">إدارة المهام</h1>\n      <button @click=\"showAddTaskModal = true\" class=\"btn btn-primary\">\n        <i class=\"fas fa-plus ml-2\"></i>إضافة مهمة جديدة\n      </button>\n    </div>\n\n    <div class=\"bg-white rounded-lg shadow-md p-4 mb-6\">\n      <div class=\"flex flex-wrap gap-4\">\n        <div class=\"relative\">\n          <input\n            type=\"text\"\n            v-model=\"searchQuery\"\n            placeholder=\"بحث في المهام...\"\n            class=\"form-input py-2 pl-10 pr-4\"\n          />\n          <i class=\"fas fa-search absolute right-3 top-3 text-gray-400\"></i>\n        </div>\n\n        <select v-model=\"filterPriority\" class=\"form-input py-2\">\n          <option value=\"\">كل الأولويات</option>\n          <option value=\"عاجل\">عاجل</option>\n          <option value=\"متوسط\">متوسط</option>\n          <option value=\"منخفض\">منخفض</option>\n        </select>\n\n        <select v-model=\"filterTag\" class=\"form-input py-2\">\n          <option value=\"\">كل التصنيفات</option>\n          <option value=\"بحث\">بحث</option>\n          <option value=\"كتابة\">كتابة</option>\n          <option value=\"تحليل\">تحليل</option>\n          <option value=\"تسجيل\">تسجيل</option>\n          <option value=\"مراجعة\">مراجعة</option>\n        </select>\n      </div>\n    </div>\n\n    <div class=\"task-board\">\n      <div v-for=\"column in columns\" :key=\"column.id\" class=\"task-column\">\n        <div class=\"flex justify-between items-center mb-4\">\n          <h3 class=\"font-bold text-gray-700\">{{ column.name }}</h3>\n          <span\n            class=\"bg-gray-200 text-gray-700 text-sm py-1 px-2 rounded-full\"\n          >\n            {{ getTasksForColumn(column.id).length }}\n          </span>\n        </div>\n\n        <div class=\"min-h-[200px]\" :id=\"column.id\" :data-column-id=\"column.id\">\n          <div\n            v-for=\"task in getTasksForColumn(column.id)\"\n            :key=\"task.id\"\n            class=\"task-card\"\n            :data-task-id=\"task.id\"\n            @click=\"openTaskDetails(task)\"\n          >\n            <div class=\"flex justify-between items-start\">\n              <h4 class=\"font-medium text-gray-800\">{{ task.name }}</h4>\n              <span\n                class=\"px-2 py-1 text-xs rounded-full\"\n                :class=\"getPriorityClass(task.priority)\"\n              >\n                {{ task.priority }}\n              </span>\n            </div>\n\n            <p v-if=\"task.description\" class=\"text-sm text-gray-600 mt-2\">\n              {{ truncateText(task.description, 100) }}\n            </p>\n\n            <div class=\"flex justify-between items-center mt-3\">\n              <div class=\"flex space-x-1 space-x-reverse\">\n                <span\n                  v-for=\"tag in task.tags\"\n                  :key=\"tag\"\n                  class=\"px-2 py-1 text-xs bg-gray-100 text-gray-600 rounded-full\"\n                >\n                  {{ tag }}\n                </span>\n              </div>\n\n              <div class=\"text-xs text-gray-500\">\n                <i class=\"far fa-calendar-alt ml-1\"></i\n                >{{ task.dueDate || \"لا يوجد موعد\" }}\n              </div>\n            </div>\n\n            <div\n              v-if=\"task.assignee\"\n              class=\"mt-3 flex items-center text-xs text-gray-500\"\n            >\n              <img\n                :src=\"`https://ui-avatars.com/api/?name=${encodeURIComponent(\n                  task.assignee\n                )}&size=24&background=0D8ABC&color=fff`\"\n                :alt=\"task.assignee\"\n                class=\"w-6 h-6 rounded-full ml-2\"\n              />\n              {{ task.assignee }}\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <!-- Task Details Modal -->\n    <div\n      v-if=\"selectedTask\"\n      class=\"modal-overlay\"\n      @click.self=\"closeTaskDetails\"\n    >\n      <div class=\"modal-content\">\n        <div class=\"flex justify-between items-center mb-4\">\n          <h2 class=\"text-xl font-bold text-gray-800\">\n            {{ selectedTask.name }}\n          </h2>\n          <button\n            @click=\"closeTaskDetails\"\n            class=\"text-gray-500 hover:text-gray-700\"\n          >\n            <i class=\"fas fa-times\"></i>\n          </button>\n        </div>\n\n        <div class=\"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4\">\n          <div>\n            <label class=\"form-label\">الحالة</label>\n            <select v-model=\"selectedTask.column\" class=\"form-input\">\n              <option\n                v-for=\"column in columns\"\n                :key=\"column.id\"\n                :value=\"column.id\"\n              >\n                {{ column.name }}\n              </option>\n            </select>\n          </div>\n\n          <div>\n            <label class=\"form-label\">الأولوية</label>\n            <select v-model=\"selectedTask.priority\" class=\"form-input\">\n              <option value=\"عاجل\">عاجل</option>\n              <option value=\"متوسط\">متوسط</option>\n              <option value=\"منخفض\">منخفض</option>\n            </select>\n          </div>\n\n          <div>\n            <label class=\"form-label\">تاريخ الاستحقاق</label>\n            <input\n              type=\"date\"\n              v-model=\"selectedTask.dueDate\"\n              class=\"form-input\"\n            />\n          </div>\n        </div>\n\n        <div class=\"mb-4\">\n          <label class=\"form-label\">الوصف</label>\n          <textarea\n            v-model=\"selectedTask.description\"\n            rows=\"4\"\n            class=\"form-input\"\n          ></textarea>\n        </div>\n\n        <div class=\"mb-4\">\n          <label class=\"form-label\">التصنيفات</label>\n          <div class=\"flex flex-wrap gap-2 mt-2\">\n            <div\n              v-for=\"tag in availableTags\"\n              :key=\"tag\"\n              @click=\"toggleTag(tag)\"\n              :class=\"[\n                'px-3 py-1 rounded-full text-sm cursor-pointer transition-colors',\n                selectedTask.tags && selectedTask.tags.includes(tag)\n                  ? 'bg-primary-100 text-primary-800 border border-primary-300'\n                  : 'bg-gray-100 text-gray-600 border border-gray-200 hover:bg-gray-200',\n              ]\"\n            >\n              {{ tag }}\n            </div>\n          </div>\n        </div>\n\n        <div class=\"mb-4\">\n          <label class=\"form-label\">المسؤول</label>\n          <select v-model=\"selectedTask.assignee\" class=\"form-input\">\n            <option value=\"\">غير معين</option>\n            <option v-for=\"user in users\" :key=\"user\">{{ user }}</option>\n          </select>\n        </div>\n\n        <div class=\"mb-4\">\n          <label class=\"form-label\">التعليقات</label>\n          <div class=\"bg-gray-50 p-3 rounded-lg max-h-40 overflow-y-auto mb-2\">\n            <div\n              v-if=\"\n                !selectedTask.comments || selectedTask.comments.length === 0\n              \"\n              class=\"text-gray-500 text-sm\"\n            >\n              لا توجد تعليقات بعد\n            </div>\n            <div\n              v-else\n              v-for=\"(comment, index) in selectedTask.comments\"\n              :key=\"index\"\n              class=\"mb-3\"\n            >\n              <div class=\"flex items-start\">\n                <div class=\"bg-white p-2 rounded-lg shadow-sm flex-grow\">\n                  <p class=\"text-sm\">{{ comment }}</p>\n                  <span class=\"text-xs text-gray-500\">منذ دقائق</span>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          <div class=\"flex\">\n            <input\n              type=\"text\"\n              v-model=\"newComment\"\n              placeholder=\"أضف تعليقًا...\"\n              class=\"form-input flex-grow\"\n              @keyup.enter=\"addComment\"\n            />\n            <button @click=\"addComment\" class=\"btn btn-primary mr-2\">\n              إضافة\n            </button>\n          </div>\n        </div>\n\n        <div class=\"flex justify-between\">\n          <div>\n            <button @click=\"saveTaskChanges\" class=\"btn btn-primary ml-2\">\n              حفظ التغييرات\n            </button>\n            <button @click=\"closeTaskDetails\" class=\"btn btn-outline\">\n              إلغاء\n            </button>\n          </div>\n          <button @click=\"deleteTask\" class=\"btn btn-danger\">حذف المهمة</button>\n        </div>\n      </div>\n    </div>\n\n    <!-- Add Task Modal -->\n    <div\n      v-if=\"showAddTaskModal\"\n      class=\"modal-overlay\"\n      @click.self=\"showAddTaskModal = false\"\n    >\n      <div class=\"modal-content\">\n        <div class=\"flex justify-between items-center mb-4\">\n          <h2 class=\"text-xl font-bold text-gray-800\">إضافة مهمة جديدة</h2>\n          <button\n            @click=\"showAddTaskModal = false\"\n            class=\"text-gray-500 hover:text-gray-700\"\n          >\n            <i class=\"fas fa-times\"></i>\n          </button>\n        </div>\n\n        <div class=\"mb-4\">\n          <label class=\"form-label\">اسم المهمة</label>\n          <input\n            type=\"text\"\n            v-model=\"newTask.name\"\n            class=\"form-input\"\n            required\n          />\n        </div>\n\n        <div class=\"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4\">\n          <div>\n            <label class=\"form-label\">الحالة</label>\n            <select v-model=\"newTask.column\" class=\"form-input\">\n              <option\n                v-for=\"column in columns\"\n                :key=\"column.id\"\n                :value=\"column.id\"\n              >\n                {{ column.name }}\n              </option>\n            </select>\n          </div>\n\n          <div>\n            <label class=\"form-label\">الأولوية</label>\n            <select v-model=\"newTask.priority\" class=\"form-input\">\n              <option value=\"عاجل\">عاجل</option>\n              <option value=\"متوسط\">متوسط</option>\n              <option value=\"منخفض\">منخفض</option>\n            </select>\n          </div>\n\n          <div>\n            <label class=\"form-label\">تاريخ الاستحقاق</label>\n            <input type=\"date\" v-model=\"newTask.dueDate\" class=\"form-input\" />\n          </div>\n        </div>\n\n        <div class=\"mb-4\">\n          <label class=\"form-label\">الوصف</label>\n          <textarea\n            v-model=\"newTask.description\"\n            rows=\"4\"\n            class=\"form-input\"\n          ></textarea>\n        </div>\n\n        <div class=\"mb-4\">\n          <label class=\"form-label\">التصنيفات</label>\n          <div class=\"flex flex-wrap gap-2 mt-2\">\n            <div\n              v-for=\"tag in availableTags\"\n              :key=\"tag\"\n              @click=\"toggleNewTaskTag(tag)\"\n              :class=\"[\n                'px-3 py-1 rounded-full text-sm cursor-pointer transition-colors',\n                newTask.tags.includes(tag)\n                  ? 'bg-primary-100 text-primary-800 border border-primary-300'\n                  : 'bg-gray-100 text-gray-600 border border-gray-200 hover:bg-gray-200',\n              ]\"\n            >\n              {{ tag }}\n            </div>\n          </div>\n        </div>\n\n        <div class=\"mb-4\">\n          <label class=\"form-label\">المسؤول</label>\n          <select v-model=\"newTask.assignee\" class=\"form-input\">\n            <option value=\"\">غير معين</option>\n            <option v-for=\"user in users\" :key=\"user\">{{ user }}</option>\n          </select>\n        </div>\n\n        <div class=\"flex justify-end\">\n          <button\n            @click=\"showAddTaskModal = false\"\n            class=\"btn btn-outline ml-2\"\n          >\n            إلغاء\n          </button>\n          <button @click=\"addNewTask\" class=\"btn btn-primary\">\n            إضافة المهمة\n          </button>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { ref, computed, onMounted } from \"vue\";\nimport {\n  getDatabase,\n  ref as dbRef,\n  onValue,\n  push,\n  update,\n  remove,\n} from \"firebase/database\";\n\nexport default {\n  name: \"Tasks\",\n  setup() {\n    const db = getDatabase();\n\n    // Task board columns\n    const columns = ref([\n      { id: \"tasks\", name: \"لم تبدأ بعد\" },\n      { id: \"inprogress\", name: \"يتم العمل عليها\" },\n      { id: \"review\", name: \"تحتاج مراجعة\" },\n      { id: \"approved\", name: \"تمت\" },\n    ]);\n\n    // Available tags and users\n    const availableTags = ref([\"بحث\", \"كتابة\", \"تحليل\", \"تسجيل\", \"مراجعة\"]);\n    const users = ref([\"د. مها\", \"فاطمة\"]);\n\n    // Tasks data\n    const tasks = ref([]);\n    const selectedTask = ref(null);\n    const newComment = ref(\"\");\n\n    // Filters\n    const searchQuery = ref(\"\");\n    const filterPriority = ref(\"\");\n    const filterTag = ref(\"\");\n\n    // New task modal\n    const showAddTaskModal = ref(false);\n    const newTask = ref({\n      name: \"\",\n      description: \"\",\n      column: \"tasks\",\n      priority: \"متوسط\",\n      dueDate: \"\",\n      tags: [],\n      assignee: \"\",\n      comments: [],\n    });\n\n    // Load tasks from Firebase\n    const loadTasks = () => {\n      const tasksRef = dbRef(db, \"tasks\");\n      onValue(tasksRef, (snapshot) => {\n        const data = snapshot.val();\n        if (data) {\n          tasks.value = Object.entries(data).map(([id, task]) => ({\n            id,\n            ...task,\n            comments: task.comments || [],\n            tags: task.tags || [],\n          }));\n        } else {\n          tasks.value = [];\n        }\n      });\n    };\n\n    // Filter tasks by column\n    const getTasksForColumn = (columnId) => {\n      return tasks.value.filter((task) => {\n        // Filter by column\n        if (task.column !== columnId) return false;\n\n        // Filter by search query\n        if (\n          searchQuery.value &&\n          !task.name.includes(searchQuery.value) &&\n          !task.description.includes(searchQuery.value)\n        ) {\n          return false;\n        }\n\n        // Filter by priority\n        if (filterPriority.value && task.priority !== filterPriority.value) {\n          return false;\n        }\n\n        // Filter by tag\n        if (\n          filterTag.value &&\n          (!task.tags || !task.tags.includes(filterTag.value))\n        ) {\n          return false;\n        }\n\n        return true;\n      });\n    };\n\n    // Task details\n    const openTaskDetails = (task) => {\n      selectedTask.value = { ...task };\n    };\n\n    const closeTaskDetails = () => {\n      selectedTask.value = null;\n      newComment.value = \"\";\n    };\n\n    const saveTaskChanges = () => {\n      if (!selectedTask.value) return;\n\n      const taskRef = dbRef(db, `tasks/${selectedTask.value.id}`);\n      update(taskRef, {\n        name: selectedTask.value.name,\n        description: selectedTask.value.description,\n        column: selectedTask.value.column,\n        priority: selectedTask.value.priority,\n        dueDate: selectedTask.value.dueDate,\n        tags: selectedTask.value.tags || [],\n        assignee: selectedTask.value.assignee,\n        comments: selectedTask.value.comments || [],\n      });\n\n      closeTaskDetails();\n    };\n\n    const deleteTask = () => {\n      if (!selectedTask.value) return;\n\n      if (confirm(\"هل أنت متأكد من حذف هذه المهمة؟\")) {\n        const taskRef = dbRef(db, `tasks/${selectedTask.value.id}`);\n        remove(taskRef);\n        closeTaskDetails();\n      }\n    };\n\n    const addComment = () => {\n      if (!newComment.value.trim() || !selectedTask.value) return;\n\n      if (!selectedTask.value.comments) {\n        selectedTask.value.comments = [];\n      }\n\n      selectedTask.value.comments.push(newComment.value.trim());\n      newComment.value = \"\";\n    };\n\n    // Tag management\n    const toggleTag = (tag) => {\n      if (!selectedTask.value) return;\n\n      if (!selectedTask.value.tags) {\n        selectedTask.value.tags = [];\n      }\n\n      const index = selectedTask.value.tags.indexOf(tag);\n      if (index === -1) {\n        selectedTask.value.tags.push(tag);\n      } else {\n        selectedTask.value.tags.splice(index, 1);\n      }\n    };\n\n    const toggleNewTaskTag = (tag) => {\n      const index = newTask.value.tags.indexOf(tag);\n      if (index === -1) {\n        newTask.value.tags.push(tag);\n      } else {\n        newTask.value.tags.splice(index, 1);\n      }\n    };\n\n    // Add new task\n    const addNewTask = () => {\n      if (!newTask.value.name.trim()) {\n        alert(\"يرجى إدخال اسم المهمة\");\n        return;\n      }\n\n      const tasksRef = dbRef(db, \"tasks\");\n      push(tasksRef, {\n        name: newTask.value.name,\n        description: newTask.value.description,\n        column: newTask.value.column,\n        priority: newTask.value.priority,\n        dueDate: newTask.value.dueDate,\n        tags: newTask.value.tags,\n        assignee: newTask.value.assignee,\n        comments: newTask.value.comments,\n        dateCreated: new Date().toISOString(),\n      });\n\n      // Reset form\n      newTask.value = {\n        name: \"\",\n        description: \"\",\n        column: \"tasks\",\n        priority: \"متوسط\",\n        dueDate: \"\",\n        tags: [],\n        assignee: \"\",\n        comments: [],\n      };\n\n      showAddTaskModal.value = false;\n    };\n\n    // Helper functions\n    const truncateText = (text, maxLength) => {\n      if (!text) return \"\";\n      return text.length > maxLength\n        ? text.substring(0, maxLength) + \"...\"\n        : text;\n    };\n\n    const getPriorityClass = (priority) => {\n      switch (priority) {\n        case \"عاجل\":\n          return \"bg-red-100 text-red-800\";\n        case \"متوسط\":\n          return \"bg-yellow-100 text-yellow-800\";\n        case \"منخفض\":\n          return \"bg-green-100 text-green-800\";\n        default:\n          return \"bg-gray-100 text-gray-800\";\n      }\n    };\n\n    // Initialize\n    onMounted(() => {\n      loadTasks();\n\n      // Initialize drag and drop (would be implemented with vuedraggable in a real app)\n      // This is a placeholder for the actual implementation\n      console.log(\"Drag and drop would be initialized here\");\n    });\n\n    return {\n      columns,\n      tasks,\n      selectedTask,\n      newComment,\n      searchQuery,\n      filterPriority,\n      filterTag,\n      availableTags,\n      users,\n      showAddTaskModal,\n      newTask,\n      getTasksForColumn,\n      openTaskDetails,\n      closeTaskDetails,\n      saveTaskChanges,\n      deleteTask,\n      addComment,\n      toggleTag,\n      toggleNewTaskTag,\n      addNewTask,\n      truncateText,\n      getPriorityClass,\n    };\n  },\n};\n</script>\n"],"mappings":";;;;AAsWA,SAASA,GAAG,EAAEC,QAAQ,EAAEC,SAAQ,QAAS,KAAK;AAC9C,SACEC,WAAW,EACXH,GAAE,IAAKI,KAAK,EACZC,OAAO,EACPC,IAAI,EACJC,MAAM,EACNC,MAAM,QACD,mBAAmB;AAE1B,eAAe;EACbC,IAAI,EAAE,OAAO;EACbC,KAAKA,CAAA,EAAG;IACN,MAAMC,EAAC,GAAIR,WAAW,CAAC,CAAC;;IAExB;IACA,MAAMS,OAAM,GAAIZ,GAAG,CAAC,CAClB;MAAEa,EAAE,EAAE,OAAO;MAAEJ,IAAI,EAAE;IAAc,CAAC,EACpC;MAAEI,EAAE,EAAE,YAAY;MAAEJ,IAAI,EAAE;IAAkB,CAAC,EAC7C;MAAEI,EAAE,EAAE,QAAQ;MAAEJ,IAAI,EAAE;IAAe,CAAC,EACtC;MAAEI,EAAE,EAAE,UAAU;MAAEJ,IAAI,EAAE;IAAM,CAAC,CAChC,CAAC;;IAEF;IACA,MAAMK,aAAY,GAAId,GAAG,CAAC,CAAC,KAAK,EAAE,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,QAAQ,CAAC,CAAC;IACvE,MAAMe,KAAI,GAAIf,GAAG,CAAC,CAAC,QAAQ,EAAE,OAAO,CAAC,CAAC;;IAEtC;IACA,MAAMgB,KAAI,GAAIhB,GAAG,CAAC,EAAE,CAAC;IACrB,MAAMiB,YAAW,GAAIjB,GAAG,CAAC,IAAI,CAAC;IAC9B,MAAMkB,UAAS,GAAIlB,GAAG,CAAC,EAAE,CAAC;;IAE1B;IACA,MAAMmB,WAAU,GAAInB,GAAG,CAAC,EAAE,CAAC;IAC3B,MAAMoB,cAAa,GAAIpB,GAAG,CAAC,EAAE,CAAC;IAC9B,MAAMqB,SAAQ,GAAIrB,GAAG,CAAC,EAAE,CAAC;;IAEzB;IACA,MAAMsB,gBAAe,GAAItB,GAAG,CAAC,KAAK,CAAC;IACnC,MAAMuB,OAAM,GAAIvB,GAAG,CAAC;MAClBS,IAAI,EAAE,EAAE;MACRe,WAAW,EAAE,EAAE;MACfC,MAAM,EAAE,OAAO;MACfC,QAAQ,EAAE,OAAO;MACjBC,OAAO,EAAE,EAAE;MACXC,IAAI,EAAE,EAAE;MACRC,QAAQ,EAAE,EAAE;MACZC,QAAQ,EAAE;IACZ,CAAC,CAAC;;IAEF;IACA,MAAMC,SAAQ,GAAIA,CAAA,KAAM;MACtB,MAAMC,QAAO,GAAI5B,KAAK,CAACO,EAAE,EAAE,OAAO,CAAC;MACnCN,OAAO,CAAC2B,QAAQ,EAAGC,QAAQ,IAAK;QAC9B,MAAMC,IAAG,GAAID,QAAQ,CAACE,GAAG,CAAC,CAAC;QAC3B,IAAID,IAAI,EAAE;UACRlB,KAAK,CAACoB,KAAI,GAAIC,MAAM,CAACC,OAAO,CAACJ,IAAI,CAAC,CAACK,GAAG,CAAC,CAAC,CAAC1B,EAAE,EAAE2B,IAAI,CAAC,MAAM;YACtD3B,EAAE;YACF,GAAG2B,IAAI;YACPV,QAAQ,EAAEU,IAAI,CAACV,QAAO,IAAK,EAAE;YAC7BF,IAAI,EAAEY,IAAI,CAACZ,IAAG,IAAK;UACrB,CAAC,CAAC,CAAC;QACL,OAAO;UACLZ,KAAK,CAACoB,KAAI,GAAI,EAAE;QAClB;MACF,CAAC,CAAC;IACJ,CAAC;;IAED;IACA,MAAMK,iBAAgB,GAAKC,QAAQ,IAAK;MACtC,OAAO1B,KAAK,CAACoB,KAAK,CAACO,MAAM,CAAEH,IAAI,IAAK;QAClC;QACA,IAAIA,IAAI,CAACf,MAAK,KAAMiB,QAAQ,EAAE,OAAO,KAAK;;QAE1C;QACA,IACEvB,WAAW,CAACiB,KAAI,IAChB,CAACI,IAAI,CAAC/B,IAAI,CAACmC,QAAQ,CAACzB,WAAW,CAACiB,KAAK,KACrC,CAACI,IAAI,CAAChB,WAAW,CAACoB,QAAQ,CAACzB,WAAW,CAACiB,KAAK,GAC5C;UACA,OAAO,KAAK;QACd;;QAEA;QACA,IAAIhB,cAAc,CAACgB,KAAI,IAAKI,IAAI,CAACd,QAAO,KAAMN,cAAc,CAACgB,KAAK,EAAE;UAClE,OAAO,KAAK;QACd;;QAEA;QACA,IACEf,SAAS,CAACe,KAAI,KACb,CAACI,IAAI,CAACZ,IAAG,IAAK,CAACY,IAAI,CAACZ,IAAI,CAACgB,QAAQ,CAACvB,SAAS,CAACe,KAAK,CAAC,GACnD;UACA,OAAO,KAAK;QACd;QAEA,OAAO,IAAI;MACb,CAAC,CAAC;IACJ,CAAC;;IAED;IACA,MAAMS,eAAc,GAAKL,IAAI,IAAK;MAChCvB,YAAY,CAACmB,KAAI,GAAI;QAAE,GAAGI;MAAK,CAAC;IAClC,CAAC;IAED,MAAMM,gBAAe,GAAIA,CAAA,KAAM;MAC7B7B,YAAY,CAACmB,KAAI,GAAI,IAAI;MACzBlB,UAAU,CAACkB,KAAI,GAAI,EAAE;IACvB,CAAC;IAED,MAAMW,eAAc,GAAIA,CAAA,KAAM;MAC5B,IAAI,CAAC9B,YAAY,CAACmB,KAAK,EAAE;MAEzB,MAAMY,OAAM,GAAI5C,KAAK,CAACO,EAAE,EAAE,SAASM,YAAY,CAACmB,KAAK,CAACvB,EAAE,EAAE,CAAC;MAC3DN,MAAM,CAACyC,OAAO,EAAE;QACdvC,IAAI,EAAEQ,YAAY,CAACmB,KAAK,CAAC3B,IAAI;QAC7Be,WAAW,EAAEP,YAAY,CAACmB,KAAK,CAACZ,WAAW;QAC3CC,MAAM,EAAER,YAAY,CAACmB,KAAK,CAACX,MAAM;QACjCC,QAAQ,EAAET,YAAY,CAACmB,KAAK,CAACV,QAAQ;QACrCC,OAAO,EAAEV,YAAY,CAACmB,KAAK,CAACT,OAAO;QACnCC,IAAI,EAAEX,YAAY,CAACmB,KAAK,CAACR,IAAG,IAAK,EAAE;QACnCC,QAAQ,EAAEZ,YAAY,CAACmB,KAAK,CAACP,QAAQ;QACrCC,QAAQ,EAAEb,YAAY,CAACmB,KAAK,CAACN,QAAO,IAAK;MAC3C,CAAC,CAAC;MAEFgB,gBAAgB,CAAC,CAAC;IACpB,CAAC;IAED,MAAMG,UAAS,GAAIA,CAAA,KAAM;MACvB,IAAI,CAAChC,YAAY,CAACmB,KAAK,EAAE;MAEzB,IAAIc,OAAO,CAAC,iCAAiC,CAAC,EAAE;QAC9C,MAAMF,OAAM,GAAI5C,KAAK,CAACO,EAAE,EAAE,SAASM,YAAY,CAACmB,KAAK,CAACvB,EAAE,EAAE,CAAC;QAC3DL,MAAM,CAACwC,OAAO,CAAC;QACfF,gBAAgB,CAAC,CAAC;MACpB;IACF,CAAC;IAED,MAAMK,UAAS,GAAIA,CAAA,KAAM;MACvB,IAAI,CAACjC,UAAU,CAACkB,KAAK,CAACgB,IAAI,CAAC,KAAK,CAACnC,YAAY,CAACmB,KAAK,EAAE;MAErD,IAAI,CAACnB,YAAY,CAACmB,KAAK,CAACN,QAAQ,EAAE;QAChCb,YAAY,CAACmB,KAAK,CAACN,QAAO,GAAI,EAAE;MAClC;MAEAb,YAAY,CAACmB,KAAK,CAACN,QAAQ,CAACxB,IAAI,CAACY,UAAU,CAACkB,KAAK,CAACgB,IAAI,CAAC,CAAC,CAAC;MACzDlC,UAAU,CAACkB,KAAI,GAAI,EAAE;IACvB,CAAC;;IAED;IACA,MAAMiB,SAAQ,GAAKC,GAAG,IAAK;MACzB,IAAI,CAACrC,YAAY,CAACmB,KAAK,EAAE;MAEzB,IAAI,CAACnB,YAAY,CAACmB,KAAK,CAACR,IAAI,EAAE;QAC5BX,YAAY,CAACmB,KAAK,CAACR,IAAG,GAAI,EAAE;MAC9B;MAEA,MAAM2B,KAAI,GAAItC,YAAY,CAACmB,KAAK,CAACR,IAAI,CAAC4B,OAAO,CAACF,GAAG,CAAC;MAClD,IAAIC,KAAI,KAAM,CAAC,CAAC,EAAE;QAChBtC,YAAY,CAACmB,KAAK,CAACR,IAAI,CAACtB,IAAI,CAACgD,GAAG,CAAC;MACnC,OAAO;QACLrC,YAAY,CAACmB,KAAK,CAACR,IAAI,CAAC6B,MAAM,CAACF,KAAK,EAAE,CAAC,CAAC;MAC1C;IACF,CAAC;IAED,MAAMG,gBAAe,GAAKJ,GAAG,IAAK;MAChC,MAAMC,KAAI,GAAIhC,OAAO,CAACa,KAAK,CAACR,IAAI,CAAC4B,OAAO,CAACF,GAAG,CAAC;MAC7C,IAAIC,KAAI,KAAM,CAAC,CAAC,EAAE;QAChBhC,OAAO,CAACa,KAAK,CAACR,IAAI,CAACtB,IAAI,CAACgD,GAAG,CAAC;MAC9B,OAAO;QACL/B,OAAO,CAACa,KAAK,CAACR,IAAI,CAAC6B,MAAM,CAACF,KAAK,EAAE,CAAC,CAAC;MACrC;IACF,CAAC;;IAED;IACA,MAAMI,UAAS,GAAIA,CAAA,KAAM;MACvB,IAAI,CAACpC,OAAO,CAACa,KAAK,CAAC3B,IAAI,CAAC2C,IAAI,CAAC,CAAC,EAAE;QAC9BQ,KAAK,CAAC,uBAAuB,CAAC;QAC9B;MACF;MAEA,MAAM5B,QAAO,GAAI5B,KAAK,CAACO,EAAE,EAAE,OAAO,CAAC;MACnCL,IAAI,CAAC0B,QAAQ,EAAE;QACbvB,IAAI,EAAEc,OAAO,CAACa,KAAK,CAAC3B,IAAI;QACxBe,WAAW,EAAED,OAAO,CAACa,KAAK,CAACZ,WAAW;QACtCC,MAAM,EAAEF,OAAO,CAACa,KAAK,CAACX,MAAM;QAC5BC,QAAQ,EAAEH,OAAO,CAACa,KAAK,CAACV,QAAQ;QAChCC,OAAO,EAAEJ,OAAO,CAACa,KAAK,CAACT,OAAO;QAC9BC,IAAI,EAAEL,OAAO,CAACa,KAAK,CAACR,IAAI;QACxBC,QAAQ,EAAEN,OAAO,CAACa,KAAK,CAACP,QAAQ;QAChCC,QAAQ,EAAEP,OAAO,CAACa,KAAK,CAACN,QAAQ;QAChC+B,WAAW,EAAE,IAAIC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC;MACtC,CAAC,CAAC;;MAEF;MACAxC,OAAO,CAACa,KAAI,GAAI;QACd3B,IAAI,EAAE,EAAE;QACRe,WAAW,EAAE,EAAE;QACfC,MAAM,EAAE,OAAO;QACfC,QAAQ,EAAE,OAAO;QACjBC,OAAO,EAAE,EAAE;QACXC,IAAI,EAAE,EAAE;QACRC,QAAQ,EAAE,EAAE;QACZC,QAAQ,EAAE;MACZ,CAAC;MAEDR,gBAAgB,CAACc,KAAI,GAAI,KAAK;IAChC,CAAC;;IAED;IACA,MAAM4B,YAAW,GAAIA,CAACC,IAAI,EAAEC,SAAS,KAAK;MACxC,IAAI,CAACD,IAAI,EAAE,OAAO,EAAE;MACpB,OAAOA,IAAI,CAACE,MAAK,GAAID,SAAQ,GACzBD,IAAI,CAACG,SAAS,CAAC,CAAC,EAAEF,SAAS,IAAI,KAAI,GACnCD,IAAI;IACV,CAAC;IAED,MAAMI,gBAAe,GAAK3C,QAAQ,IAAK;MACrC,QAAQA,QAAQ;QACd,KAAK,MAAM;UACT,OAAO,yBAAyB;QAClC,KAAK,OAAO;UACV,OAAO,+BAA+B;QACxC,KAAK,OAAO;UACV,OAAO,6BAA6B;QACtC;UACE,OAAO,2BAA2B;MACtC;IACF,CAAC;;IAED;IACAxB,SAAS,CAAC,MAAM;MACd6B,SAAS,CAAC,CAAC;;MAEX;MACA;MACAuC,OAAO,CAACC,GAAG,CAAC,yCAAyC,CAAC;IACxD,CAAC,CAAC;IAEF,OAAO;MACL3D,OAAO;MACPI,KAAK;MACLC,YAAY;MACZC,UAAU;MACVC,WAAW;MACXC,cAAc;MACdC,SAAS;MACTP,aAAa;MACbC,KAAK;MACLO,gBAAgB;MAChBC,OAAO;MACPkB,iBAAiB;MACjBI,eAAe;MACfC,gBAAgB;MAChBC,eAAe;MACfE,UAAU;MACVE,UAAU;MACVE,SAAS;MACTK,gBAAgB;MAChBC,UAAU;MACVK,YAAY;MACZK;IACF,CAAC;EACH;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}