{"ast":null,"code":"import { createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, toDisplayString as _toDisplayString, withModifiers as _withModifiers } from \"vue\";\nconst _hoisted_1 = {\n  class: \"fade-in\"\n};\nconst _hoisted_2 = {\n  class: \"flex justify-between items-center mb-6\"\n};\nconst _hoisted_3 = {\n  class: \"flex space-x-2 space-x-reverse\"\n};\nconst _hoisted_4 = {\n  class: \"grid grid-cols-1 md:grid-cols-2 gap-6\"\n};\nconst _hoisted_5 = {\n  class: \"bg-white rounded-lg shadow-md p-6\"\n};\nconst _hoisted_6 = {\n  key: 0,\n  class: \"text-center py-8 text-gray-500\"\n};\nconst _hoisted_7 = {\n  key: 1,\n  class: \"space-y-4\"\n};\nconst _hoisted_8 = {\n  class: \"font-medium text-gray-800\"\n};\nconst _hoisted_9 = {\n  class: \"text-sm text-gray-500\"\n};\nconst _hoisted_10 = {\n  class: \"flex items-center\"\n};\nconst _hoisted_11 = [\"href\"];\nconst _hoisted_12 = [\"onClick\"];\nconst _hoisted_13 = {\n  class: \"bg-white rounded-lg shadow-md p-6\"\n};\nconst _hoisted_14 = {\n  key: 0,\n  class: \"text-center py-8 text-gray-500\"\n};\nconst _hoisted_15 = {\n  key: 1,\n  class: \"space-y-4\"\n};\nconst _hoisted_16 = {\n  class: \"font-medium text-gray-800\"\n};\nconst _hoisted_17 = {\n  class: \"text-sm text-gray-500\"\n};\nconst _hoisted_18 = {\n  class: \"flex items-center\"\n};\nconst _hoisted_19 = [\"href\"];\nconst _hoisted_20 = [\"onClick\"];\nconst _hoisted_21 = {\n  class: \"bg-white rounded-lg shadow-md p-6 mt-6\"\n};\nconst _hoisted_22 = {\n  class: \"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\"\n};\nconst _hoisted_23 = {\n  class: \"p-4 bg-gray-50 rounded-lg\"\n};\nconst _hoisted_24 = {\n  class: \"text-2xl font-bold text-primary-600\"\n};\nconst _hoisted_25 = {\n  class: \"p-4 bg-gray-50 rounded-lg\"\n};\nconst _hoisted_26 = {\n  class: \"text-2xl font-bold text-primary-600\"\n};\nconst _hoisted_27 = {\n  class: \"p-4 bg-gray-50 rounded-lg\"\n};\nconst _hoisted_28 = {\n  class: \"text-2xl font-bold text-primary-600\"\n};\nconst _hoisted_29 = {\n  class: \"p-4 bg-gray-50 rounded-lg\"\n};\nconst _hoisted_30 = {\n  class: \"text-2xl font-bold text-primary-600\"\n};\nconst _hoisted_31 = {\n  class: \"modal-content\"\n};\nconst _hoisted_32 = {\n  class: \"flex justify-between items-center mb-4\"\n};\nconst _hoisted_33 = {\n  class: \"mb-4\"\n};\nconst _hoisted_34 = {\n  class: \"flex justify-end\"\n};\nconst _hoisted_35 = [\"disabled\"];\nconst _hoisted_36 = {\n  key: 0,\n  class: \"fas fa-spinner fa-spin ml-1\"\n};\nconst _hoisted_37 = {\n  class: \"modal-content\"\n};\nconst _hoisted_38 = {\n  class: \"flex justify-between items-center mb-4\"\n};\nconst _hoisted_39 = {\n  class: \"mb-4\"\n};\nconst _hoisted_40 = {\n  class: \"flex justify-end\"\n};\nconst _hoisted_41 = [\"disabled\"];\nconst _hoisted_42 = {\n  key: 0,\n  class: \"fas fa-spinner fa-spin ml-1\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_cache[14] || (_cache[14] = _createElementVNode(\"h1\", {\n    class: \"text-2xl font-bold text-gray-800\"\n  }, \"الخطابات والموافقات\", -1)), _createElementVNode(\"div\", _hoisted_3, [_createElementVNode(\"button\", {\n    onClick: _cache[0] || (_cache[0] = $event => $setup.showAddDoctorLetterModal = true),\n    class: \"btn btn-primary ml-2\"\n  }, _cache[12] || (_cache[12] = [_createElementVNode(\"i\", {\n    class: \"fas fa-plus ml-2\"\n  }, null, -1), _createTextVNode(\"إضافة موافقة دكتور \")])), _createElementVNode(\"button\", {\n    onClick: _cache[1] || (_cache[1] = $event => $setup.showAddParentLetterModal = true),\n    class: \"btn btn-secondary\"\n  }, _cache[13] || (_cache[13] = [_createElementVNode(\"i\", {\n    class: \"fas fa-plus ml-2\"\n  }, null, -1), _createTextVNode(\"إضافة موافقة ولي أمر \")]))])]), _createElementVNode(\"div\", _hoisted_4, [_createElementVNode(\"div\", _hoisted_5, [_cache[17] || (_cache[17] = _createElementVNode(\"h2\", {\n    class: \"text-xl font-bold text-gray-800 mb-4\"\n  }, \"موافقات الدكاترة\", -1)), $setup.doctorLetters.length === 0 ? (_openBlock(), _createElementBlock(\"div\", _hoisted_6, \" لا توجد موافقات دكاترة حتى الآن \")) : (_openBlock(), _createElementBlock(\"div\", _hoisted_7, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.doctorLetters, letter => {\n    return _openBlock(), _createElementBlock(\"div\", {\n      key: letter.id,\n      class: \"bg-gray-50 rounded-lg p-4 flex justify-between items-center\"\n    }, [_createElementVNode(\"div\", null, [_createElementVNode(\"h3\", _hoisted_8, _toDisplayString(letter.name), 1), _createElementVNode(\"p\", _hoisted_9, _toDisplayString($setup.formatDate(letter.timestamp)), 1)]), _createElementVNode(\"div\", _hoisted_10, [_createElementVNode(\"a\", {\n      href: letter.url,\n      target: \"_blank\",\n      class: \"text-primary-600 hover:text-primary-800 ml-4\"\n    }, _cache[15] || (_cache[15] = [_createElementVNode(\"i\", {\n      class: \"fas fa-external-link-alt ml-1\"\n    }, null, -1), _createTextVNode(\"عرض \")]), 8, _hoisted_11), _createElementVNode(\"button\", {\n      onClick: $event => $setup.deleteLetter('doctor', letter),\n      class: \"text-red-600 hover:text-red-800\"\n    }, _cache[16] || (_cache[16] = [_createElementVNode(\"i\", {\n      class: \"fas fa-trash-alt\"\n    }, null, -1)]), 8, _hoisted_12)])]);\n  }), 128))]))]), _createElementVNode(\"div\", _hoisted_13, [_cache[20] || (_cache[20] = _createElementVNode(\"h2\", {\n    class: \"text-xl font-bold text-gray-800 mb-4\"\n  }, \" موافقات أولياء الأمور \", -1)), $setup.parentLetters.length === 0 ? (_openBlock(), _createElementBlock(\"div\", _hoisted_14, \" لا توجد موافقات أولياء أمور حتى الآن \")) : (_openBlock(), _createElementBlock(\"div\", _hoisted_15, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.parentLetters, letter => {\n    return _openBlock(), _createElementBlock(\"div\", {\n      key: letter.id,\n      class: \"bg-gray-50 rounded-lg p-4 flex justify-between items-center\"\n    }, [_createElementVNode(\"div\", null, [_createElementVNode(\"h3\", _hoisted_16, _toDisplayString(letter.name), 1), _createElementVNode(\"p\", _hoisted_17, _toDisplayString($setup.formatDate(letter.timestamp)), 1)]), _createElementVNode(\"div\", _hoisted_18, [_createElementVNode(\"a\", {\n      href: letter.url,\n      target: \"_blank\",\n      class: \"text-primary-600 hover:text-primary-800 ml-4\"\n    }, _cache[18] || (_cache[18] = [_createElementVNode(\"i\", {\n      class: \"fas fa-external-link-alt ml-1\"\n    }, null, -1), _createTextVNode(\"عرض \")]), 8, _hoisted_19), _createElementVNode(\"button\", {\n      onClick: $event => $setup.deleteLetter('parent', letter),\n      class: \"text-red-600 hover:text-red-800\"\n    }, _cache[19] || (_cache[19] = [_createElementVNode(\"i\", {\n      class: \"fas fa-trash-alt\"\n    }, null, -1)]), 8, _hoisted_20)])]);\n  }), 128))]))])]), _createElementVNode(\"div\", _hoisted_21, [_cache[25] || (_cache[25] = _createElementVNode(\"h2\", {\n    class: \"text-xl font-bold text-gray-800 mb-4\"\n  }, \"حالة الموافقات\", -1)), _createElementVNode(\"div\", _hoisted_22, [_createElementVNode(\"div\", _hoisted_23, [_cache[21] || (_cache[21] = _createElementVNode(\"h3\", {\n    class: \"font-semibold text-gray-700 mb-2\"\n  }, \" إجمالي موافقات الدكاترة \", -1)), _createElementVNode(\"p\", _hoisted_24, _toDisplayString($setup.doctorLetters.length), 1)]), _createElementVNode(\"div\", _hoisted_25, [_cache[22] || (_cache[22] = _createElementVNode(\"h3\", {\n    class: \"font-semibold text-gray-700 mb-2\"\n  }, \" إجمالي موافقات أولياء الأمور \", -1)), _createElementVNode(\"p\", _hoisted_26, _toDisplayString($setup.parentLetters.length), 1)]), _createElementVNode(\"div\", _hoisted_27, [_cache[23] || (_cache[23] = _createElementVNode(\"h3\", {\n    class: \"font-semibold text-gray-700 mb-2\"\n  }, \" نسبة اكتمال موافقات الدكاترة \", -1)), _createElementVNode(\"p\", _hoisted_28, _toDisplayString($setup.doctorCompletionPercentage) + \"% \", 1)]), _createElementVNode(\"div\", _hoisted_29, [_cache[24] || (_cache[24] = _createElementVNode(\"h3\", {\n    class: \"font-semibold text-gray-700 mb-2\"\n  }, \" نسبة اكتمال موافقات أولياء الأمور \", -1)), _createElementVNode(\"p\", _hoisted_30, _toDisplayString($setup.parentCompletionPercentage) + \"% \", 1)])])]), $setup.showAddDoctorLetterModal ? (_openBlock(), _createElementBlock(\"div\", {\n    key: 0,\n    class: \"modal-overlay\",\n    onClick: _cache[6] || (_cache[6] = _withModifiers($event => $setup.showAddDoctorLetterModal = false, [\"self\"]))\n  }, [_createElementVNode(\"div\", _hoisted_31, [_createElementVNode(\"div\", _hoisted_32, [_cache[27] || (_cache[27] = _createElementVNode(\"h2\", {\n    class: \"text-xl font-bold text-gray-800\"\n  }, \"إضافة موافقة دكتور\", -1)), _createElementVNode(\"button\", {\n    onClick: _cache[2] || (_cache[2] = $event => $setup.showAddDoctorLetterModal = false),\n    class: \"text-gray-500 hover:text-gray-700\"\n  }, _cache[26] || (_cache[26] = [_createElementVNode(\"i\", {\n    class: \"fas fa-times\"\n  }, null, -1)]))]), _createElementVNode(\"div\", _hoisted_33, [_cache[28] || (_cache[28] = _createElementVNode(\"label\", {\n    class: \"form-label\"\n  }, \"ملف الموافقة (PDF)\", -1)), _createElementVNode(\"input\", {\n    type: \"file\",\n    accept: \"application/pdf\",\n    onChange: _cache[3] || (_cache[3] = (...args) => $setup.handleDoctorFileUpload && $setup.handleDoctorFileUpload(...args)),\n    class: \"form-input\",\n    required: \"\"\n  }, null, 32)]), _createElementVNode(\"div\", _hoisted_34, [_createElementVNode(\"button\", {\n    onClick: _cache[4] || (_cache[4] = $event => $setup.showAddDoctorLetterModal = false),\n    class: \"btn btn-outline ml-2\"\n  }, \" إلغاء \"), _createElementVNode(\"button\", {\n    onClick: _cache[5] || (_cache[5] = (...args) => $setup.uploadDoctorLetter && $setup.uploadDoctorLetter(...args)),\n    class: \"btn btn-primary\",\n    disabled: $setup.isUploading\n  }, [$setup.isUploading ? (_openBlock(), _createElementBlock(\"i\", _hoisted_36)) : _createCommentVNode(\"\", true), _cache[29] || (_cache[29] = _createTextVNode(\" رفع الملف \"))], 8, _hoisted_35)])])])) : _createCommentVNode(\"\", true), $setup.showAddParentLetterModal ? (_openBlock(), _createElementBlock(\"div\", {\n    key: 1,\n    class: \"modal-overlay\",\n    onClick: _cache[11] || (_cache[11] = _withModifiers($event => $setup.showAddParentLetterModal = false, [\"self\"]))\n  }, [_createElementVNode(\"div\", _hoisted_37, [_createElementVNode(\"div\", _hoisted_38, [_cache[31] || (_cache[31] = _createElementVNode(\"h2\", {\n    class: \"text-xl font-bold text-gray-800\"\n  }, \"إضافة موافقة ولي أمر\", -1)), _createElementVNode(\"button\", {\n    onClick: _cache[7] || (_cache[7] = $event => $setup.showAddParentLetterModal = false),\n    class: \"text-gray-500 hover:text-gray-700\"\n  }, _cache[30] || (_cache[30] = [_createElementVNode(\"i\", {\n    class: \"fas fa-times\"\n  }, null, -1)]))]), _createElementVNode(\"div\", _hoisted_39, [_cache[32] || (_cache[32] = _createElementVNode(\"label\", {\n    class: \"form-label\"\n  }, \"ملف الموافقة (PDF)\", -1)), _createElementVNode(\"input\", {\n    type: \"file\",\n    accept: \"application/pdf\",\n    onChange: _cache[8] || (_cache[8] = (...args) => $setup.handleParentFileUpload && $setup.handleParentFileUpload(...args)),\n    class: \"form-input\",\n    required: \"\"\n  }, null, 32)]), _createElementVNode(\"div\", _hoisted_40, [_createElementVNode(\"button\", {\n    onClick: _cache[9] || (_cache[9] = $event => $setup.showAddParentLetterModal = false),\n    class: \"btn btn-outline ml-2\"\n  }, \" إلغاء \"), _createElementVNode(\"button\", {\n    onClick: _cache[10] || (_cache[10] = (...args) => $setup.uploadParentLetter && $setup.uploadParentLetter(...args)),\n    class: \"btn btn-primary\",\n    disabled: $setup.isUploading\n  }, [$setup.isUploading ? (_openBlock(), _createElementBlock(\"i\", _hoisted_42)) : _createCommentVNode(\"\", true), _cache[33] || (_cache[33] = _createTextVNode(\" رفع الملف \"))], 8, _hoisted_41)])])])) : _createCommentVNode(\"\", true)]);\n}","map":{"version":3,"names":["class","key","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_hoisted_3","onClick","_cache","$event","$setup","showAddDoctorLetterModal","_createTextVNode","showAddParentLetterModal","_hoisted_4","_hoisted_5","doctorLetters","length","_hoisted_6","_hoisted_7","_Fragment","_renderList","letter","id","_hoisted_8","_toDisplayString","name","_hoisted_9","formatDate","timestamp","_hoisted_10","href","url","target","_hoisted_11","deleteLetter","_hoisted_12","_hoisted_13","parentLetters","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_21","_hoisted_22","_hoisted_23","_hoisted_24","_hoisted_25","_hoisted_26","_hoisted_27","_hoisted_28","doctorCompletionPercentage","_hoisted_29","_hoisted_30","parentCompletionPercentage","_withModifiers","_hoisted_31","_hoisted_32","_hoisted_33","type","accept","onChange","args","handleDoctorFileUpload","required","_hoisted_34","uploadDoctorLetter","disabled","isUploading","_hoisted_36","_createCommentVNode","_hoisted_35","_hoisted_37","_hoisted_38","_hoisted_39","handleParentFileUpload","_hoisted_40","uploadParentLetter","_hoisted_42","_hoisted_41"],"sources":["C:\\Users\\فاطمة الزهراني\\Downloads\\research-task-manager-updated\\task-manager\\src\\views\\Letters.vue"],"sourcesContent":["<template>\n  <div class=\"fade-in\">\n    <div class=\"flex justify-between items-center mb-6\">\n      <h1 class=\"text-2xl font-bold text-gray-800\">الخطابات والموافقات</h1>\n      <div class=\"flex space-x-2 space-x-reverse\">\n        <button\n          @click=\"showAddDoctorLetterModal = true\"\n          class=\"btn btn-primary ml-2\"\n        >\n          <i class=\"fas fa-plus ml-2\"></i>إضافة موافقة دكتور\n        </button>\n        <button\n          @click=\"showAddParentLetterModal = true\"\n          class=\"btn btn-secondary\"\n        >\n          <i class=\"fas fa-plus ml-2\"></i>إضافة موافقة ولي أمر\n        </button>\n      </div>\n    </div>\n\n    <div class=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n      <div class=\"bg-white rounded-lg shadow-md p-6\">\n        <h2 class=\"text-xl font-bold text-gray-800 mb-4\">موافقات الدكاترة</h2>\n\n        <div\n          v-if=\"doctorLetters.length === 0\"\n          class=\"text-center py-8 text-gray-500\"\n        >\n          لا توجد موافقات دكاترة حتى الآن\n        </div>\n\n        <div v-else class=\"space-y-4\">\n          <div\n            v-for=\"letter in doctorLetters\"\n            :key=\"letter.id\"\n            class=\"bg-gray-50 rounded-lg p-4 flex justify-between items-center\"\n          >\n            <div>\n              <h3 class=\"font-medium text-gray-800\">{{ letter.name }}</h3>\n              <p class=\"text-sm text-gray-500\">\n                {{ formatDate(letter.timestamp) }}\n              </p>\n            </div>\n\n            <div class=\"flex items-center\">\n              <a\n                :href=\"letter.url\"\n                target=\"_blank\"\n                class=\"text-primary-600 hover:text-primary-800 ml-4\"\n              >\n                <i class=\"fas fa-external-link-alt ml-1\"></i>عرض\n              </a>\n              <button\n                @click=\"deleteLetter('doctor', letter)\"\n                class=\"text-red-600 hover:text-red-800\"\n              >\n                <i class=\"fas fa-trash-alt\"></i>\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div class=\"bg-white rounded-lg shadow-md p-6\">\n        <h2 class=\"text-xl font-bold text-gray-800 mb-4\">\n          موافقات أولياء الأمور\n        </h2>\n\n        <div\n          v-if=\"parentLetters.length === 0\"\n          class=\"text-center py-8 text-gray-500\"\n        >\n          لا توجد موافقات أولياء أمور حتى الآن\n        </div>\n\n        <div v-else class=\"space-y-4\">\n          <div\n            v-for=\"letter in parentLetters\"\n            :key=\"letter.id\"\n            class=\"bg-gray-50 rounded-lg p-4 flex justify-between items-center\"\n          >\n            <div>\n              <h3 class=\"font-medium text-gray-800\">{{ letter.name }}</h3>\n              <p class=\"text-sm text-gray-500\">\n                {{ formatDate(letter.timestamp) }}\n              </p>\n            </div>\n\n            <div class=\"flex items-center\">\n              <a\n                :href=\"letter.url\"\n                target=\"_blank\"\n                class=\"text-primary-600 hover:text-primary-800 ml-4\"\n              >\n                <i class=\"fas fa-external-link-alt ml-1\"></i>عرض\n              </a>\n              <button\n                @click=\"deleteLetter('parent', letter)\"\n                class=\"text-red-600 hover:text-red-800\"\n              >\n                <i class=\"fas fa-trash-alt\"></i>\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <div class=\"bg-white rounded-lg shadow-md p-6 mt-6\">\n      <h2 class=\"text-xl font-bold text-gray-800 mb-4\">حالة الموافقات</h2>\n\n      <div class=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\n        <div class=\"p-4 bg-gray-50 rounded-lg\">\n          <h3 class=\"font-semibold text-gray-700 mb-2\">\n            إجمالي موافقات الدكاترة\n          </h3>\n          <p class=\"text-2xl font-bold text-primary-600\">\n            {{ doctorLetters.length }}\n          </p>\n        </div>\n\n        <div class=\"p-4 bg-gray-50 rounded-lg\">\n          <h3 class=\"font-semibold text-gray-700 mb-2\">\n            إجمالي موافقات أولياء الأمور\n          </h3>\n          <p class=\"text-2xl font-bold text-primary-600\">\n            {{ parentLetters.length }}\n          </p>\n        </div>\n\n        <div class=\"p-4 bg-gray-50 rounded-lg\">\n          <h3 class=\"font-semibold text-gray-700 mb-2\">\n            نسبة اكتمال موافقات الدكاترة\n          </h3>\n          <p class=\"text-2xl font-bold text-primary-600\">\n            {{ doctorCompletionPercentage }}%\n          </p>\n        </div>\n\n        <div class=\"p-4 bg-gray-50 rounded-lg\">\n          <h3 class=\"font-semibold text-gray-700 mb-2\">\n            نسبة اكتمال موافقات أولياء الأمور\n          </h3>\n          <p class=\"text-2xl font-bold text-primary-600\">\n            {{ parentCompletionPercentage }}%\n          </p>\n        </div>\n      </div>\n    </div>\n\n    <!-- Add Doctor Letter Modal -->\n    <div\n      v-if=\"showAddDoctorLetterModal\"\n      class=\"modal-overlay\"\n      @click.self=\"showAddDoctorLetterModal = false\"\n    >\n      <div class=\"modal-content\">\n        <div class=\"flex justify-between items-center mb-4\">\n          <h2 class=\"text-xl font-bold text-gray-800\">إضافة موافقة دكتور</h2>\n          <button\n            @click=\"showAddDoctorLetterModal = false\"\n            class=\"text-gray-500 hover:text-gray-700\"\n          >\n            <i class=\"fas fa-times\"></i>\n          </button>\n        </div>\n\n        <div class=\"mb-4\">\n          <label class=\"form-label\">ملف الموافقة (PDF)</label>\n          <input\n            type=\"file\"\n            accept=\"application/pdf\"\n            @change=\"handleDoctorFileUpload\"\n            class=\"form-input\"\n            required\n          />\n        </div>\n\n        <div class=\"flex justify-end\">\n          <button\n            @click=\"showAddDoctorLetterModal = false\"\n            class=\"btn btn-outline ml-2\"\n          >\n            إلغاء\n          </button>\n          <button\n            @click=\"uploadDoctorLetter\"\n            class=\"btn btn-primary\"\n            :disabled=\"isUploading\"\n          >\n            <i v-if=\"isUploading\" class=\"fas fa-spinner fa-spin ml-1\"></i>\n            رفع الملف\n          </button>\n        </div>\n      </div>\n    </div>\n\n    <!-- Add Parent Letter Modal -->\n    <div\n      v-if=\"showAddParentLetterModal\"\n      class=\"modal-overlay\"\n      @click.self=\"showAddParentLetterModal = false\"\n    >\n      <div class=\"modal-content\">\n        <div class=\"flex justify-between items-center mb-4\">\n          <h2 class=\"text-xl font-bold text-gray-800\">إضافة موافقة ولي أمر</h2>\n          <button\n            @click=\"showAddParentLetterModal = false\"\n            class=\"text-gray-500 hover:text-gray-700\"\n          >\n            <i class=\"fas fa-times\"></i>\n          </button>\n        </div>\n\n        <div class=\"mb-4\">\n          <label class=\"form-label\">ملف الموافقة (PDF)</label>\n          <input\n            type=\"file\"\n            accept=\"application/pdf\"\n            @change=\"handleParentFileUpload\"\n            class=\"form-input\"\n            required\n          />\n        </div>\n\n        <div class=\"flex justify-end\">\n          <button\n            @click=\"showAddParentLetterModal = false\"\n            class=\"btn btn-outline ml-2\"\n          >\n            إلغاء\n          </button>\n          <button\n            @click=\"uploadParentLetter\"\n            class=\"btn btn-primary\"\n            :disabled=\"isUploading\"\n          >\n            <i v-if=\"isUploading\" class=\"fas fa-spinner fa-spin ml-1\"></i>\n            رفع الملف\n          </button>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { ref, computed, onMounted } from \"vue\";\nimport {\n  getDatabase,\n  ref as dbRef,\n  onValue,\n  push,\n  remove,\n} from \"firebase/database\";\nimport {\n  getStorage,\n  ref as storageRef,\n  uploadBytesResumable,\n  getDownloadURL,\n  deleteObject,\n} from \"firebase/storage\";\n\nexport default {\n  name: \"Letters\",\n  setup() {\n    const db = getDatabase();\n    const storage = getStorage();\n\n    // Letters data\n    const doctorLetters = ref([]);\n    const parentLetters = ref([]);\n\n    // Modals\n    const showAddDoctorLetterModal = ref(false);\n    const showAddParentLetterModal = ref(false);\n\n    // Upload state\n    const selectedDoctorFile = ref(null);\n    const selectedParentFile = ref(null);\n    const isUploading = ref(false);\n\n    // Load letters from Firebase\n    const loadLetters = () => {\n      // Load doctor letters\n      const doctorLettersRef = dbRef(db, \"doctor_letters\");\n      onValue(doctorLettersRef, (snapshot) => {\n        const data = snapshot.val();\n        if (data) {\n          doctorLetters.value = Object.entries(data).map(([id, letter]) => ({\n            id,\n            ...letter,\n          }));\n        } else {\n          doctorLetters.value = [];\n        }\n      });\n\n      // Load parent letters\n      const parentLettersRef = dbRef(db, \"parent_letters\");\n      onValue(parentLettersRef, (snapshot) => {\n        const data = snapshot.val();\n        if (data) {\n          parentLetters.value = Object.entries(data).map(([id, letter]) => ({\n            id,\n            ...letter,\n          }));\n        } else {\n          parentLetters.value = [];\n        }\n      });\n    };\n\n    // Computed properties\n    const doctorCompletionPercentage = computed(() => {\n      // Assuming we need 5 doctor approvals\n      const targetCount = 5;\n      return Math.min(\n        Math.round((doctorLetters.value.length / targetCount) * 100),\n        100\n      );\n    });\n\n    const parentCompletionPercentage = computed(() => {\n      // Assuming we need 10 parent approvals\n      const targetCount = 10;\n      return Math.min(\n        Math.round((parentLetters.value.length / targetCount) * 100),\n        100\n      );\n    });\n\n    // File upload handlers\n    const handleDoctorFileUpload = (event) => {\n      selectedDoctorFile.value = event.target.files[0];\n    };\n\n    const handleParentFileUpload = (event) => {\n      selectedParentFile.value = event.target.files[0];\n    };\n\n    // Upload doctor letter\n    const uploadDoctorLetter = () => {\n      if (!selectedDoctorFile.value) {\n        alert(\"يرجى اختيار ملف\");\n        return;\n      }\n\n      isUploading.value = true;\n      const fileName = selectedDoctorFile.value.name;\n      const storagePath = `doctor_letters/${fileName}`;\n\n      // Upload file to Firebase Storage\n      const fileRef = storageRef(storage, storagePath);\n      const uploadTask = uploadBytesResumable(\n        fileRef,\n        selectedDoctorFile.value\n      );\n\n      uploadTask.on(\n        \"state_changed\",\n        (snapshot) => {\n          // Progress monitoring if needed\n          const progress =\n            (snapshot.bytesTransferred / snapshot.totalBytes) * 100;\n          console.log(\"Upload is \" + progress + \"% done\");\n        },\n        (error) => {\n          // Error handling\n          console.error(\"Error uploading file:\", error);\n          isUploading.value = false;\n          alert(\"حدث خطأ أثناء رفع الملف\");\n        },\n        () => {\n          // Upload completed successfully\n          getDownloadURL(uploadTask.snapshot.ref).then((downloadURL) => {\n            // Save letter data to Firebase Database\n            const lettersRef = dbRef(db, \"doctor_letters\");\n            push(lettersRef, {\n              name: fileName,\n              url: downloadURL,\n              storagePath: storagePath,\n              timestamp: Date.now(),\n            });\n\n            selectedDoctorFile.value = null;\n            isUploading.value = false;\n            showAddDoctorLetterModal.value = false;\n          });\n        }\n      );\n    };\n\n    // Upload parent letter\n    const uploadParentLetter = () => {\n      if (!selectedParentFile.value) {\n        alert(\"يرجى اختيار ملف\");\n        return;\n      }\n\n      isUploading.value = true;\n      const fileName = selectedParentFile.value.name;\n      const storagePath = `parent_letters/${fileName}`;\n\n      // Upload file to Firebase Storage\n      const fileRef = storageRef(storage, storagePath);\n      const uploadTask = uploadBytesResumable(\n        fileRef,\n        selectedParentFile.value\n      );\n\n      uploadTask.on(\n        \"state_changed\",\n        (snapshot) => {\n          // Progress monitoring if needed\n          const progress =\n            (snapshot.bytesTransferred / snapshot.totalBytes) * 100;\n          console.log(\"Upload is \" + progress + \"% done\");\n        },\n        (error) => {\n          // Error handling\n          console.error(\"Error uploading file:\", error);\n          isUploading.value = false;\n          alert(\"حدث خطأ أثناء رفع الملف\");\n        },\n        () => {\n          // Upload completed successfully\n          getDownloadURL(uploadTask.snapshot.ref).then((downloadURL) => {\n            // Save letter data to Firebase Database\n            const lettersRef = dbRef(db, \"parent_letters\");\n            push(lettersRef, {\n              name: fileName,\n              url: downloadURL,\n              storagePath: storagePath,\n              timestamp: Date.now(),\n            });\n\n            selectedParentFile.value = null;\n            isUploading.value = false;\n            showAddParentLetterModal.value = false;\n          });\n        }\n      );\n    };\n\n    // Delete letter\n    const deleteLetter = (type, letter) => {\n      if (!confirm(\"هل أنت متأكد من حذف هذا الملف؟\")) return;\n\n      // Delete file from storage\n      const fileRef = storageRef(storage, letter.storagePath);\n      deleteObject(fileRef).catch((error) => {\n        console.error(\"Error deleting file:\", error);\n      });\n\n      // Delete data from database\n      const letterRef = dbRef(db, `${type}_letters/${letter.id}`);\n      remove(letterRef);\n    };\n\n    // Download templates\n    const downloadDoctorTemplate = () => {\n      // In a real app, this would download a template file\n      alert(\"سيتم تنزيل نموذج موافقة الدكاترة (هذه وظيفة تجريبية)\");\n    };\n\n    const downloadParentTemplate = () => {\n      // In a real app, this would download a template file\n      alert(\"سيتم تنزيل نموذج موافقة أولياء الأمور (هذه وظيفة تجريبية)\");\n    };\n\n    // Helper functions\n    const formatDate = (timestamp) => {\n      if (!timestamp) return \"\";\n      const date = new Date(timestamp);\n      return date.toLocaleDateString(\"ar-EG\");\n    };\n\n    // Initialize\n    onMounted(() => {\n      loadLetters();\n    });\n\n    return {\n      doctorLetters,\n      parentLetters,\n      showAddDoctorLetterModal,\n      showAddParentLetterModal,\n      isUploading,\n      doctorCompletionPercentage,\n      parentCompletionPercentage,\n      handleDoctorFileUpload,\n      handleParentFileUpload,\n      uploadDoctorLetter,\n      uploadParentLetter,\n      deleteLetter,\n      downloadDoctorTemplate,\n      downloadParentTemplate,\n      formatDate,\n    };\n  },\n};\n</script>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}